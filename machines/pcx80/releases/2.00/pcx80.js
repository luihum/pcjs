(function(){/*
 https://www.pcjs.org/machines/shared/lib/dumpapi.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/shared/lib/reportapi.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/shared/lib/userapi.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/shared/lib/keys.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/shared/lib/strlib.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/shared/lib/weblib.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/cpudef.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/messages.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/shared/lib/state.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/shared/lib/embed.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/shared/lib/defines.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/shared/lib/usrlib.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/shared/lib/component.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/defines.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/panel.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/bus.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/memory.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/cpu.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/cpustate.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/cpuops.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/chipset.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/rom.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/ram.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/keyboard.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/video.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/serial.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/shared/lib/debugger.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/debugger.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/machines/pcx80/lib/computer.js (C) 2012-2021 Jeff Parsons
*/
var m;function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function ba(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:aa(a)}}function ea(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}var fa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ha;
if("function"==typeof Object.setPrototypeOf)ha=Object.setPrototypeOf;else{var ia;a:{var ja={vb:!0},ka={};try{ka.__proto__=ja;ia=ka.vb;break a}catch(a){}ia=!1}ha=ia?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var na=ha;
function oa(a,b){a.prototype=fa(b.prototype);a.prototype.constructor=a;if(na)na(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c]}var pa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
function qa(a){a=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}return globalThis}var ra=qa(this);function sa(a,b){if(b){var c=ra;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&pa(c,a,{configurable:!0,writable:!0,value:b})}}
sa("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||Infinity===b||-Infinity===b||0===b)return b;var c=Math.floor(Math.abs(b));return 0>b?-c:c}});
var n={Be:0,Ee:1,Fe:2,Ge:3,He:4,Ie:5,Je:6,Ke:7,Le:8,Me:9,Ne:10,Oe:11,Pe:12,Qe:13,Re:14,Se:15,Te:16,Ue:17,Ve:18,We:19,Xe:20,Ye:21,Ze:22,$e:23,af:24,bf:25,cf:26,jf:27," ":32,"!":33,'"':34,"#":35,$:36,"%":37,"&":38,"'":39,"(":40,")":41,"*":42,"+":43,",":44,"-":45,".":46,"/":47,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,":":58,";":59,"<":60,"=":61,">":62,"?":63,"@":64,Ya:65,Tb:66,Ub:67,Cb:68,E:69,Xb:70,Yb:71,Zb:72,$b:73,ac:74,bc:75,Eb:76,fc:77,gc:78,kc:79,lc:80,Q:81,mc:82,oc:83,pc:84,qc:85,sc:86,
tc:87,vc:88,wc:89,tb:90,"[":91,"\\":92,"]":93,"^":94,_:95,"`":96,vb:97,sd:98,ud:99,d:100,e:101,yd:102,Ad:103,Cd:104,Ed:105,Nd:106,k:107,Od:108,Qd:109,n:110,Rd:111,p:112,q:113,r:114,ne:115,t:116,pe:117,qe:118,re:119,x:120,y:121,z:122,"{":123,"|":124,"}":125,"~":126,df:127},ua={59:186,61:187,173:189,224:91};function va(){}
function wa(a,b){if(a){b||(b=10);var c,d=0<a.indexOf(",");d&&(a=a.replace(/,/g,""));var e=c=a.charAt(0);"#"==c?(b=8,c=""):"$"==c&&(b=16,c="");e!=c?a=a.substr(1):(e=c=a.substr(0,2),"0b"==c&&d||"^B"==c?(b=2,c=""):"0o"==c||"^O"==c?(b=8,c=""):"^D"==c?(b=10,c=""):"0x"==c&&(b=16,c=""),e!=c&&(a=a.substr(2)));e=c=a.slice(-1);"Y"==c||"y"==c?(b=2,c=""):"."==c?(b=10,c=""):"H"==c||"h"==c?(b=16,c=""):"K"==c?c="000":"M"==c?c="000000":"G"==c&&(c="000000000");e!=c&&(a=a.slice(0,-1)+c);var f;e=0;10>=b&&(c=a.match(/(-?[0-9]+)B([0-9]*)/))&&
(a=c[1],e=35-((c[2]||35)&255));if((b&&10!=b?16==b?null!==a.match(/^-?[0-9a-f]+$/i):8==b?null!==a.match(/^-?[0-7]+$/):2==b&&null!==a.match(/^-?[01]+$/):null!==a.match(/^-?[0-9]+$/))&&!isNaN(f=parseInt(a,b))){e&&(0>f&&(f+=Math.pow(2,36)),f=0<e?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));var g=f}}return g}
function xa(a,b,c,d,e){e=void 0===e?0:e;var f="";isNaN(a)||"number"!=typeof a?a=null:(0>a&&-1<a&&(a=-1),0>a&&(a+=Math.pow(b,c)),a>=Math.pow(b,c)&&(c=Math.ceil(Math.log(a)/Math.log(b))));for(var g=e||-1;0<c--;){g||(f=","+f,g=e);if(null==a)f="?"+f;else{var h=a%b;h+=0<=h&&9>=h?48:55;f=String.fromCharCode(h)+f;a=Math.trunc(a/b)}g--}return(void 0===d?"":d)+f}function r(a,b,c){b?9<b&&(b=9):(b=Math.abs(a),b=65535>=b?4:4294967295>=b?8:9);return xa(a,16,b,c?"0x":"")}function za(a){return r(a,2,!0)}
function t(a){return r(a,4,!0)}function Aa(a){var b=a,c=a.lastIndexOf("/");0<=c&&(b=a.substr(c+1));c=b.indexOf("&");0<c&&(b=b.substr(0,c));return b}function Ba(a){var b="",c=a.lastIndexOf(".");0<=c&&(b=a.substr(c+1).toLowerCase());return b}function Ca(){var a=window?window.location.hostname:"localhost";return-1!==a.indexOf("pcjs.org",a.length-8)}function Da(a){return a.replace(/[&<>"'$]/g,function(b){return Fa[b]})}function Ga(a,b){return(a+"                                        ").slice(0,b)}
function Ha(a){for(var b=[],c=0;c<arguments.length;++c)b[c]=arguments[c];return void 0===b[0]?new Date(Date.now()):"string"===typeof b[0]?new Date(b[0]+" "+(b[1]||"00:00:00 GMT")):void 0===b[1]?new Date(b[0]):new Date(Date.UTC.apply(Date,b instanceof Array?b:ea(ba(b))))}
function Ia(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(!c||!c.length)return a;d="";var e=a.split(/%([-+ 0#]*)([0-9]*|\*)(\.[0-9]+|)([hlL]?)([A-Za-z%])/),f=0,g;for(g=0;g<e.length-6;g+=6){d+=e[g];var h=e[g+5],k="ACDFHIMNSTWYbdfjcsoXx%".indexOf(h);if(0>k)d+="%"+e[g+1]+e[g+2]+e[g+3]+e[g+4]+h;else{if(f<c.length){var l=c[f];"%"!=h&&f++}else l=c[c.length-1];var p=e[g+1],u=0<=p.indexOf("#"),y=0<=p.indexOf("0"),q=e[g+2];"*"==q?(q=l,l=f<c.length?c[f++]:c[c.length-1]):q=+q||0;var w=
e[g+3];w=w?+w.substr(1):-1;var z=null,D=0,G="";k=12>k&&"object"!=typeof l?Ha(l):l;switch(h){case "C":l=u?"#":"";d+=isNaN(k.getTime())?void 0:Ia(Ia("%%%sW, %%%sF %%%sD, %%%sY",l),k);continue;case "D":l=u?k.getUTCDate():k.getDate();h="d";break;case "A":case "G":case "H":l=u?k.getUTCHours():k.getHours();"A"==h?(l=12>l?"am":"pm",h="s"):("G"==h&&(l=l?12<l?l-12:l:12),h="d");break;case "F":case "M":l=u?k.getUTCMonth():k.getMonth();"F"==h?(l=Ja[l],h="s"):(l++,h="d");break;case "N":l=u?k.getUTCMinutes():k.getMinutes();
h="d";break;case "S":l=u?k.getUTCSeconds():k.getSeconds();h="d";break;case "T":l=u?"#":"";d+=isNaN(k.getTime())?void 0:Ia(Ia("%%%sY-%%%s02M-%%%s02D %%%s02H:%%%s02N:%%%s02S",l),k);continue;case "W":l=Ka[u?k.getUTCDay():k.getDay()];h="s";break;case "Y":l=u?k.getUTCFullYear():k.getFullYear(),0<w&&(l%=Math.pow(10,w),w=-1),h="d"}switch(h){case "b":d+=l?"true":"false";break;case "d":l=Math.trunc(l),0<=w&&(y=!0,q<w&&(q=w),w=-1);case "f":h=l+"";0<=w&&(h=l.toFixed(w));h.length<q&&(y?(0>l&&(q--,h=h.substr(1)),
h=("0000000000"+h).slice(-q),0>l&&(h="-"+h)):h=("          "+h).slice(-q));d+=h;break;case "j":d+=JSON.stringify(l,null,q||void 0);break;case "c":l="string"==typeof l?l[0]:String.fromCharCode(l);case "s":if(void 0!=l)for("string"!=typeof l&&(l=l.toString()),0<=w&&(l=l.substr(0,w));l.length<q;)l=0<=p.indexOf("-")?l+" ":" "+l;d+=l;break;case "o":D=8,u&&(G="0");case "X":z=La;case "x":h="";D||(D=16);!G&&u&&(G="0x");z||(z=Ma);l=Math.trunc(l);0<=w&&(y=!0,q<w&&(q=w));y&&!q&&(q=Math.abs(l),q=255>=q?2:65535>=
q?4:4294967295>=q?8:9,q+=G.length);q-=G.length;do u=l&D-1,l>>>=16==D?4:3,y||!h||u||l?h=z[u]+h:(G&&(h=G+h,G=""),0<q&&(h=" "+h));while(0<--q||l);d+=G+h;break;case "%":d+="%";break;default:d+="(unimplemented printf type %"+h+")"}}}return d+=e[g]}function Na(a){return String.prototype.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}
var Fa={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;",$:"&dollar;"},Oa={0:"NUL",1:"SOH",2:"STX",3:"ETX",4:"EOT",5:"ENQ",6:"ACK",7:"BEL",8:"BS",9:"TAB",10:"LF",11:"VT",12:"FF",13:"CR",14:"SO",15:"SI",16:"DLE",17:"XON",18:"DC2",19:"XOFF",20:"DC4",21:"NAK",22:"SYN",23:"ETB",24:"CAN",25:"EM",26:"SUB",27:"ESC",28:"FS",29:"GS",30:"RS",31:"US",127:"DEL"},Ma="0123456789abcdef",La="0123456789ABCDEF",Ka="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ja="January February March April May June July August September October November December".split(" ");
function Pa(a,b,c){var d=0,e=a.length,f=0;for(void 0===c&&(c=function(k,l){return k>l?1:k<l?-1:0});d<e;){var g=d+e>>1,h=void 0;h=c(b,a[g]);0<h?d=g+1:(e=g,f=!h)}return f?d:~d}function Ra(a,b){if(Array.prototype.indexOf)return a.indexOf(b,c);var c=c||0;0>c&&(c+=a.length);0>c&&(c=0);for(var d=a.length;c<d;c++)if(c in a&&a[c]===b)return c;return-1}
function Sa(a,b,c,d){function e(){if(4!==k.readyState)return null;try{g=l?k.response:k.responseText}catch(q){}if(null==g||200!=k.status&&(k.status||!g.length||"file:"!=(window?window.location.protocol:"file:")))if(f=k.status||-1,!k.status&&!Ta){var y=a.match(/(^https?:\/\/[^/]+)(.*)/);y&&(Ta=!0,v("PCjs was unable to perform a cross-origin resource request to '"+y[1]+"'.\n\nIf you're running an ad blocker, try adding '"+Ua()+"' to your whitelist (or find a smarter ad blocker)."))}d&&d(a,g,f);return[g,
f]}b=void 0===b?"text":b;c=void 0===c?!1:c;var f=0,g=null,h=null;if("object"==typeof resources&&(g=resources[a]))return d&&d(a,g,f),[g,f];if(c&&"function"==typeof resources)return resources(a,function(y,q){d&&d(a,y,q)}),h;a=a.replace(/^\/(diskettes|gamedisks|harddisks|decdisks|pcsig[0-9a-z]*-disks|private)\//,"https://$1.pcjs.org/").replace(/^\/discs\/([^/]*)\//,"https://$1.pcjs.org/");var k=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),l=!1,p="string"===
typeof k.responseType;c&&(k.onreadystatechange=e);if(b&&"object"==typeof b){p="";for(var u in b)b.hasOwnProperty(u)&&(p&&(p+="&"),p+=u+"="+encodeURIComponent(b[u]));p=p.replace(/%20/g,"+");k.open("POST",a,c);k.setRequestHeader("Content-type","application/x-www-form-urlencoded");k.send(p)}else k.open("GET",a,c),"arraybuffer"==b&&(p?(l=!0,k.responseType=b):k.overrideMimeType("text/plain; charset=x-user-defined")),k.send();c||(k.readyState=4,h=e());return h}
function Va(a,b){var c,d={ka:null,pa:null,Na:null,Fa:null};if("["==b.charAt(0)||"{"==b.charAt(0))try{var e,f;if("<"==b.charAt(0))throw Error(b);if(0>b.indexOf("0x")&&0>b.indexOf("0o")&&'["'!=b.substr(0,2)){0>b.indexOf('"values"')&&(b=b.replace(/([a-z]+):/gm,'"$1":').replace(/\/\/[^\n]*/gm,""));var g=JSON.parse(b)}else g=eval("("+b+")");d.Na=g.load;d.Fa=g.exec;var h=g.width,k=g.values;h&&k&&(8==h?g.bytes=k:16==h?g.words=k:32==h?g.longs=k:g.data=k);if(e=g.bytes)d.ka=e;else if(e=g.words)for(d.ka=Array(2*
e.length),f=c=0;c<e.length;c++)d.ka[f++]=e[c]&255,d.ka[f++]=e[c]>>8&255;else if(e=g.longs)for(d.ka=Array(4*e.length),f=c=0;c<e.length;c++)d.ka[f++]=e[c]&255,d.ka[f++]=e[c]>>8&255,d.ka[f++]=e[c]>>16&255,d.ka[f++]=e[c]>>24&255;else(e=g.data)?d.Nf=e:d.ka=g;d.ka&&(d.ka.length?1==d.ka.length&&(v(d.ka[0]),d=null):(v("Empty resource: "+a),d=null));d.pa=g.symbols}catch(l){v("Resource data error ("+a+"): "+l.message),d=null}else{e=[];b=b.replace(/\n/gm," ").replace(/ +$/,"").split(" ");for(c=0;c<b.length;c++){f=
parseInt(b[c],16);if(isNaN(f)){v("Resource data error ("+a+"): invalid hex byte ("+b[c]+")");break}e.push(f&255)}c==b.length&&(d.ka=e)}return d}function Ua(){return window?window.location.protocol+"//"+window.location.host:"https://www.pcjs.org"}function Wa(){return window?window.navigator.userAgent:""}
function Xa(){if(null==Ya){var a=!1;if(window)try{window.localStorage.setItem("PCjs.localStorage","PCjs.localStorage"),a="PCjs.localStorage"==window.localStorage.getItem("PCjs.localStorage"),window.localStorage.removeItem("PCjs.localStorage")}catch(b){a=!1}Ya=a}return Ya}function Za(a){if(window)try{var b=window.localStorage.getItem(a)}catch(c){}return b}function $a(a,b){try{return window.localStorage.setItem(a,b),!0}catch(c){}return!1}
function ab(a){if(window){var b=Wa();return"iOS"==a&&(!!b.match(/(iPod|iPhone|iPad)/)||"MacIntel"===window.navigator.platform&&1<window.navigator.maxTouchPoints)||"MSIE"==a&&!!b.match(/(MSIE|Trident)/)||0<=b.indexOf(a)}return!1}function bb(a,b,c){if(a)for(var d=0;d<cb.length;d++){var e=cb[d];if(c){if(e+=c,b+e in a)return e}else if(e=e?e+b[0].toUpperCase():b[0],e+=b.substr(1),e in a)return e}return null}
function gb(a){if(!hb){var b,c={};if(window){b||(b=window.location.search.substr(1));for(var d,e=/\+/g,f=/([^&=]+)=?([^&]*)/g;d=f.exec(b);)c[decodeURIComponent(d[1].replace(e," "))]=decodeURIComponent(d[2].replace(e," "))}hb=c}return hb[a]||hb[a.toLowerCase()]}function ib(a,b,c){function d(){--a;0<=a&&(b()||(a=0));0<a?setTimeout(d,0):c()}d()}
function jb(a,b){function c(){b(100===d)&&(e=setTimeout(c,d),d=100)}var d=0,e=null,f=!1;a.onmousedown=function(){f||e||(d=500,c())};a.ontouchstart=function(){e||(d=500,c())};a.onmouseup=a.onmouseout=function(){e&&(clearTimeout(e),e=null)};a.ontouchend=a.ontouchcancel=function(){e&&(clearTimeout(e),e=null);f=!0}}function kb(a,b){if(window){var c=window[a];window[a]="function"!==typeof c?b:function(){c&&c();b()}}}function lb(a){mb.init.push(a)}
function nb(a){ob(a+"\n\nIf it happens again, please send the URL to support@pcjs.org. Thanks.",void 0,void 0)}function pb(a){if(qb)try{for(var b=0;b<a.length;b++)a[b]()}catch(c){nb("An unexpected error occurred: "+c.message)}}function sb(a){!qb&&a?(qb=!0,tb&&ub("init"),vb&&ub("show")):qb=a}function ub(a){mb[a]&&pb(mb[a])}var hb=null,mb={init:[],show:[],exit:[]},cb=["","moz","ms","webkit"],tb=!1,vb=!1,qb=!0,Ta=!1,Ya=null;kb("onload",function(){tb=!0;pb(mb.init)});
kb("onpageshow",function(){vb=!0;pb(mb.show)});kb(ab("iOS")?"onpagehide":ab("Opera")?"onunload":"onbeforeunload",function(){pb(mb.exit)});
function x(a,b,c){this.type=a;b||(b={id:"",name:""});this.name=b.name;this.uc=b.comment;this.Bd=b;this.id=this.id=b.id||"";this.exports={};this.O=this.bindings={};a=this.id.indexOf(".");0>a?(this.Pa="PCjs",this.Fb=this.id):(this.Pa=this.id.substr(0,a),this.Fb=this.id.substr(a+1));this.flags={ready:!1,hb:!1,Gb:!1,Of:!1,ha:!1,Pb:!1,error:!1};this.xb=null;this.flags.error=!1;this.fa=c||0;this.J=this.w=this.H=this.P=null;wb.push(this)}function xb(a,b,c){yb[a]&&b&&(yb[a][b]=c)}
function zb(){return Date.now()||+new Date}function ob(a,b,c){b||v((c?c+": ":"")+a)}function v(a){window&&window.alert(a)}function Ab(a){var b=!1;window&&(b=window.confirm(a));return b}function Bb(a,b){a.value+=b;b=a.value;8192<b.length&&(a.value=b.substr(b.length-4096));a.scrollTop=a.scrollHeight}
function Db(a,b){b=Eb(b.parentNode,"pcx80-control");for(var c=0;c<b.length;c++)for(var d=b[c].childNodes,e=0;e<d.length;e++){var f=d[e];if(1===f.nodeType){var g=f.getAttribute("class");if(g)for(var h=g.split(" "),k=0;k<h.length;k++)switch(g=h[k],g){case "pcx80-binding":(g=Fb(f))&&void 0!==g.binding&&a.ca(g.type,g.binding,f,g.value),k=h.length}}}}function Gb(a){var b,c=[];a&&(a=0<(b=a.indexOf("."))?a.substr(0,b+1):"");for(b=0;b<wb.length;b++){var d=wb[b];a&&d.id.indexOf(a)||c.push(d)}return c}
function Hb(a){if(void 0!==a){var b;for(b=0;b<wb.length;b++)if(wb[b].id===a)return wb[b]}return null}function Ib(a,b){var c;if(void 0!==a){var d;b&&(b=0<(d=b.indexOf("."))?b.substr(0,d+1):"");for(d=0;d<wb.length;d++)if(c)c==wb[d]&&(c=null);else if(!(a!=wb[d].type||b&&wb[d].id.indexOf(b)))return wb[d]}return null}function Fb(a){var b=null;if(a=a.getAttribute("data-value"))try{b=eval("("+a+")")}catch(c){v(c.message+" ("+a+")")}return b}
function Eb(a,b,c){c&&(b+="-"+c+"-object");if(a.getElementsByClassName)return a.getElementsByClassName(b);var d;c=[];a=a.getElementsByTagName("*");var e=new RegExp("(^| )"+b+"( |$)");b=0;for(d=a.length;b<d;b++)e.test(a[b].className)&&c.push(a[b]);return c}
function Jb(a){for(var b=!0,c=Kb[a];c&&c.length;){var d=c.splice(0,1)[0],e=d[0],f=null;0<=Lb.indexOf(e)&&(f=function(){return function(){Jb(a)}}());var g=Mb[e];if(g)if(!f)b=g(d[1],d[2],d[3]);else{if(!g(f,d[1],d[2],d[3]))break}else{b=!1;var h=Ib(d[1],a);if(h)if(g=Nb[e])b=g(h,d[2],d[3]);else{var k=h.exports;if(k&&(g=k[e]))if(b=!0,!f)b=g.call(h,d[2],d[3]);else if(!g.call(h,f,d[2],d[3]))break}}if(!b){v("Script error: '"+e+"' command "+(g?" failed":" not recognized"));break}}c&&!c.length&&delete Kb[a];
return b}m=x.prototype;m.toString=function(){return this.name?this.name:this.id||this.type};
m.ca=function(a,b,c){switch(b){case "clear":return this.O[b]||(this.O[b]=c,c.onclick=function(d){return function(){d.O.print&&(d.O.print.value="")}}(this)),!0;case "print":return this.O[b]||(this.O[b]=c,this.Z=function(d){this.i(d,this.type);return!0},c.value="",this.print=function(d){return function(e){Bb(d,e)}}(c),this.i=function(d,e){return function(f,g){f||(f="");if(g!=Ob||"..."!=f.slice(-3))g&&(f=g+": "+f),Bb(e,f+"\n");else{g=e.value;var h=g.lastIndexOf(f);g=0>h?g+(f+"\n"):g.substr(0,h)+(f+".")+
g.substr(h+f.length);8192<g.length&&(g=g.substr(g.length-4096));e.value=g;e.scrollTop=e.scrollHeight}}}(this,c)),!0;default:return!1}};m.log=function(){};m.print=function(){};m.i=function(){};m.status=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];this.i(this.type+": "+Ia.apply(va,[a].concat(c instanceof Array?c:ea(ba(c)))))};
m.Z=function(a,b,c){if(!b){var d=Ib("Computer",this.id);if(d&&d.flags.Pb)return console.log("ignoring notice during unload: "+a),!1}ob(a,b,c||this.type);return!0};function Pb(a,b){a.flags.error=!0;a.Z(b)}function Qb(a,b){b&&(a.flags.ready?b():a.xb=b);return a.flags.ready}function Rb(a){if(!a.flags.error&&(a.flags.ready=!0,a.flags.ready)){var b=a.xb;a.xb=null;b&&b()}}function Sb(a,b){a.flags.hb&&(b?a.flags.Gb=!0:void 0===b&&a.i(a.toString()+" busy"));return a.flags.hb}
function Tb(a,b){if(a.flags.Gb)return a.flags.hb=!1,a.flags.Gb=!1;if(a.flags.error)return a.i(a.toString()+" error"),!1;a.flags.hb=b;return a.flags.hb}m.ta=function(){return this.flags.ha=!0};m.sa=function(a,b){b&&(this.flags.ha=!1);return!0};function Ub(a,b){b=void 0===b?0:b;if(a.J){b%2&&b--;b=b||a.fa;var c;if(!(c=-1==(b|1))){a=a.J.fa;c=Math.pow(2,32);var d=b/c|0;c=(a&b)==(b|0)&&((a/c|0)&d)==d}if(c)return!0}return!1}
function Vb(a,b){var c;a.J&&("boolean"==typeof c&&(c=c?-1:0),Ub(a,c)&&a.J.message(b,void 0))}function A(a,b,c,d,e,f,g){a.J&&(!0===g?g=0:void 0==g&&(g=a.fa),Yb(a.J,a,b,c,d,e,f,g))}var Ob="progress";window&&(window.PCjs||(window.PCjs={}),window.PCjs.Machines||(window.PCjs.Machines={}),window.PCjs.Components||(window.PCjs.Components=[]),window.PCjs.Commands||(window.PCjs.Commands={}));
var yb=window?window.PCjs.Machines:{},wb=window?window.PCjs.Components:[],Kb=window?window.PCjs.Commands:{},Lb=["hold","sleep","wait"],Mb={alert:function(a){v(a);return!0},sleep:function(a,b){setTimeout(a,+b);return!1}},Nb={select:function(a,b,c){var d=!1;if(a=a.bindings[b])for(b=0;b<a.options.length;b++)if(a.options[b].textContent==c){a.selectedIndex!=b&&(a.selectedIndex=b);d=!0;break}return d}};
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;b<c;b++)if(this[b]===a)return b;return-1});Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return e.apply(this instanceof c&&a?this:a,d.concat(Array.prototype.slice.call(arguments)))}function c(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind: non-callable object");var d=Array.prototype.slice.call(arguments,1),e=this;c.prototype=this.prototype;b.prototype=new c;return b});
var Zb="undefined"!==typeof ArrayBuffer,$b=[1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,
0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1],ac={cpu:2,bus:4,mem:8,port:16,nvr:32,chipset:64,keyboard:128,key:256,video:512,fdc:1024,disk:2048,serial:4096,speaker:8192,computer:16384,warn:268435456,halt:536870912,buffer:1073741824};function bc(a){x.call(this,"Panel",a)}oa(bc,x);bc.prototype.ca=function(a,b,c,d){return this.P&&this.P.ca(a,b,c,d)||this.w&&this.w.ca(a,b,c,d)||this.B&&this.B.ca(a,b,c,d)||this.J&&this.J.ca(a,b,c,d)?!0:x.prototype.ca.call(this,a,b,c,d)};
bc.prototype.Da=function(a,b,c,d){this.P=a;this.H=b;this.w=c;this.J=d;this.B=cc(a,"Keyboard")};bc.prototype.ta=function(a,b){b||dc();return!0};bc.prototype.sa=function(){return!0};function dc(){for(var a=!1,b=Eb(document,"pcx80","panel"),c=0;c<b.length;c++){var d=b[c],e=Fb(d),f=Hb(e.id);f||(a=!0,f=new bc(e));Db(f,d);a&&Rb(f)}}lb(dc);
function ec(a,b,c){x.call(this,"Bus",a);this.w=b;this.J=c;this.L=a.busWidth||16;this.M=Math.pow(2,this.L);this.C=this.M-1|0;this.g=(this.L>>1)+2;10>this.g&&(this.g=10);15<this.g&&(this.g=15);this.u=1<<this.g;this.N=this.u>>2;this.j=this.u-1;this.I=this.M/this.u|0;this.G=this.I-1;this.A=[];this.B=[];this.D=this.F=!1;this.R=[];this.S=[];a=new B;fc(a,this.J);this.b=Array(this.I);for(b=0;b<this.I;b++)this.b[b]=a;Rb(this)}oa(ec,x);ec.prototype.reset=function(){};
ec.prototype.ta=function(a,b){b||this.reset();return!0};function gc(a,b,c,d){for(var e=b,f=c,g=e>>>a.g;0<f&&g<a.b.length;){var h=a.b[g],k=g*a.u,l=a.u-(e-k);l>f&&(l=f);if(h&&h.size){if(h.type==d){if(e+f<=h.K)return h.lb+=h.K-e,h.K=e,!0;if(e>=h.K+h.lb){l=h.size-(e-k);l>f&&(l=f);h.lb=e-h.K+l;e=k+a.u;f-=l;g++;continue}}return hc(ic,e,f)}e=new B(e,l,a.u,d);fc(e,a.J,h);a.b[g++]=e;e=k+a.u;f-=l}return 0>=f?(a.status("%dKb %s at 0x%04X",Math.floor(c/1024),jc[d],b),!0):hc(kc,b,c)}
function lc(a,b){return a.b[(b&a.C)>>>a.g].kb(b&a.j,b)}function mc(a,b){var c=b&a.j,d=(b&a.C)>>>a.g;return c!=a.j?a.b[d].Gc(c,b):a.b[d++].Va(c,b)|a.b[d&a.G].Va(0,b+1)<<8}function nc(a,b){var c=b&a.j,d=(b&a.C)>>>a.g;return c!=a.j?a.b[d].Lb(c,b):a.b[d++].kb(c,b)|a.b[d&a.G].kb(0,b+1)<<8}function oc(a,b,c){a.b[(b&a.C)>>>a.g].mb(b&a.j,c&255,b)}function pc(a,b,c){var d=b&a.j,e=(b&a.C)>>>a.g;d!=a.j?a.b[e].Jc(d,c&65535,b):(a.b[e++].Xa(d,c&255,b),a.b[e&a.G].Xa(0,c>>8&255,b+1))}
function zc(a){for(var b=0,c=[],d=0;d<a.I;d++){var e=a.b[d];if(e.Ca||e.Cc){c[b++]=d;var f=b++;if(e=e.save()){for(var g=0,h=0,k=[];g<e.length;){for(var l=e[g],p=g+1;p<e.length&&e[p]===l;)p++;k[h++]=p-g;k[h++]=l;g=p}k.length<e.length&&(e=k)}c[f]=e}}return c}function Ac(a,b){if(void 0===b)return a.D=!a.D,a.D;void 0===a.A[b]&&(a.A[b]=[null,!1]);a.A[b][1]=!a.A[b][1];return a.A[b][1]}
function Bc(a,b,c,d){void 0===d&&(d=0);if(c)for(var e in c){var f=a,g=+e+d,h=c[e].bind(b);if(void 0!==h)for(var k=+e+d;k<=g;k++)void 0!==f.A[k]?v("Input port "+t(k)+" already registered"):f.A[k]=[h,!1]}}function Cc(a,b,c){for(var d=1,e=0,f=0;0<d;){var g=a.A[b],h=a.R[b]||1,k=1==h?255:2==h?65535:-1,l=k;void 0!==g?(g[0]&&(l=g[0](b,c),void 0===l?l=k:l&=k),a.J&&a.D!=g[1]&&Dc(a.J,b,l)):a.J&&(Yb(a.J,a,b,null,c),a.D&&Dc(a.J,b,l));e|=l<<f;f+=h<<3;b+=h;d-=h}return e}
function Ec(a,b){if(void 0===b)return a.F=!a.F,a.F;void 0===a.B[b]&&(a.B[b]=[null,!1]);a.B[b][1]=!a.B[b][1];return a.B[b][1]}function Fc(a,b,c,d){void 0===d&&(d=0);if(c)for(var e in c){var f=a,g=+e+d,h=c[e].bind(b);if(void 0!==h)for(var k=+e+d;k<=g;k++)void 0!==f.B[k]?v("Output port "+t(k)+" already registered"):f.B[k]=[h,!1]}}
function Gc(a,b,c,d){for(var e=1,f=0;0<e;){var g=a.B[b],h=a.S[b]||1,k=1==h?255:2==h?65535:-1;k&=c>>>=f;if(void 0!==g){if(g[0])g[0](b,k,d);a.J&&a.F!=g[1]&&Hc(a.J,b,k)}else a.J&&(Yb(a.J,a,b,k,d),a.F&&Hc(a.J,b,k));f+=h<<3;b+=h;e-=h}}function hc(a,b,c){v("Memory block error ("+a+": "+r(b)+","+r(c)+")");return!1}var ic=1,kc=2,Ic;if(Zb){var Jc=new ArrayBuffer(2);(new DataView(Jc)).setUint16(0,256,!0);Ic=256===(new Uint16Array(Jc))[0]}else Ic=!1;var Kc=Ic;
function B(a,b,c,d){this.id=Lc+=2;this.b=null;this.K=a;this.lb=b;this.size=c||0;this.type=d||Mc;this.w=d==Nc;fc(this);this.Ca=this.Cc=!1;if(c)if(Zb)this.P=new ArrayBuffer(c),this.j=new DataView(this.P,0,c),this.g=new Uint8Array(this.P,0,c),this.u=new Uint16Array(this.P,0,c>>1),this.b=new Int32Array(this.P,0,c>>2),Oc(this,Kc?Pc:Qc);else{this.b=Array(c>>2);for(a=0;a<this.b.length;a++)this.b[a]=0;Oc(this,Rc)}else Oc(this)}m=B.prototype;
m.save=function(){var a;if(Zb){var b=Array(this.size>>2);for(a=0;a<b.length;a++)b[a]=this.j.getInt32(a<<2,!0)}else b=this.b;return b};m.restore=function(a){if(a&&this.size==a.length<<2){var b;if(Zb)for(b=0;b<a.length;b++)this.j.setInt32(b<<2,a[b],!0);else this.b=a;return this.Ca=!0}return!1};function Oc(a,b){b||(b=Sc);Tc(a,b,void 0);Uc(a,b,void 0)}function Tc(a,b,c){c&&a.H||(a.Va=b[0]||a.Fc,a.Gc=b[2]||a.Hc);if(c||void 0===c)a.kb=b[0]||a.Fc,a.Lb=b[2]||a.Hc}
function Uc(a,b,c){c&&a.O||(a.Xa=!a.w&&b[1]||a.nb,a.Jc=!a.w&&b[3]||a.Qb);if(c||void 0===c)a.mb=b[1]||a.nb,a.Rb=b[3]||a.Qb}m.Ma=function(a,b){b?0===this.O++&&Uc(this,Vc,!1):0===this.H++&&Tc(this,Vc,!1)};function Wc(a,b){b?0===--a.O&&(a.Xa=a.w?a.nb:a.mb,a.Jc=a.w?a.Qb:a.Rb):0===--a.H&&(a.Va=a.kb,a.Gc=a.Lb)}function fc(a,b,c){a.J=b;a.H=a.O=0;c&&((a.H=c.H)&&Tc(a,Vc,!1),(a.O=c.O)&&Uc(a,Vc,!1))}m.Fc=function(){this.J&&Ub(this.J,10)&&this.J.message("attempt to read invalid block %"+r(this.K),!0);return 255};
m.nb=function(a,b){this.J&&Ub(this.J,10)&&this.J.message("attempt to write "+t(b)+" to invalid block %"+r(this.K),!0)};m.Hc=function(a,b){return this.Va(a++,b++)|this.Va(a,b)<<8};m.Qb=function(a,b,c){this.Xa(a++,b&255,c++);this.Xa(a,b>>8,c)};m.he=function(a){return this.b[a>>2]>>>((a&3)<<3)&255};m.le=function(a){var b=a>>2;a=(a&3)<<3;var c=this.b[b]>>a;return 24>a?c&65535:c&255|(this.b[b+1]&255)<<8};m.ve=function(a,b){var c=a>>2;a=(a&3)<<3;this.b[c]=this.b[c]&~(255<<a)|b<<a;this.Ca=!0};
m.ze=function(a,b){var c=a>>2;a=(a&3)<<3;24>a?this.b[c]=this.b[c]&~(65535<<a)|b<<a:(this.b[c]=this.b[c]&16777215|b<<24,c++,this.b[c]=this.b[c]&-256|b>>8);this.Ca=!0};m.fe=function(a,b){if(this.J&&null!=this.K){var c=this.J;Xc(c,this.K+a,1,c.M)&&Yc(c,!0)}return this.kb(a,b)};m.je=function(a,b){if(this.J&&null!=this.K){var c=this.J;Xc(c,this.K+a,2,c.M)&&Yc(c,!0)}return this.Lb(a,b)};
m.te=function(a,b,c){if(this.J&&null!=this.K){var d=this.J;Xc(d,this.K+a,1,d.B)&&Yc(d,!0)}this.w?this.nb(a,b,c):this.mb(a,b,c)};m.xe=function(a,b,c){if(this.J&&null!=this.K){var d=this.J;Xc(d,this.K+a,2,d.B)&&Yc(d,!0)}this.w?this.nb(a,b,c):this.Rb(a,b,c)};m.ee=function(a){return this.g[a]};m.ge=function(a){return this.g[a]};m.ie=function(a){return this.j.getUint16(a,!0)};m.ke=function(a){return a&1?this.g[a]|this.g[a+1]<<8:this.u[a>>1]};m.se=function(a,b){this.g[a]=b;this.Ca=!0};
m.ue=function(a,b){this.g[a]=b;this.Ca=!0};m.we=function(a,b){this.j.setUint16(a,b,!0);this.Ca=!0};m.ye=function(a,b){a&1?(this.g[a]=b,this.g[a+1]=b>>8):this.u[a>>1]=b;this.Ca=!0};var Mc=0,Nc=2,jc=["NONE","RAM","ROM","VID","H/W"],Lc=0,Sc=[],Rc=[B.prototype.he,B.prototype.ve,B.prototype.le,B.prototype.ze],Vc=[B.prototype.fe,B.prototype.te,B.prototype.je,B.prototype.xe];if(Zb)var Qc=[B.prototype.ee,B.prototype.se,B.prototype.ie,B.prototype.we],Pc=[B.prototype.ge,B.prototype.ue,B.prototype.ke,B.prototype.ye];
function Zc(a,b){x.call(this,"CPU",a,2);var c=a.multiplier||1;this.xa=a.cycles||b;this.S=c;this.Ra=Math.round(this.xa/1E4)/100;this.Y=this.Ra*this.S;this.flags.ia=!1;this.flags.Ob=!1;this.flags.gb=a.autoStart;this.flags.Ac=!1;this.flags.Ua=!1;this.ua=this.ma=0;this.wa=a.csStart;this.la=a.csInterval;this.qa=a.csStop;this.T=[];this.ob=this.qb.bind(this);Rb(this)}oa(Zc,x);m=Zc.prototype;
m.Da=function(a,b,c,d){this.P=a;this.H=b;this.J=d;for(b=0;b<$c.length;b++)(c=this.O[$c[b]])&&this.P.ca("",$c[b],c);this.V=cc(a,"ChipSet");a=ad(a,"autoStart");null!=a&&(this.flags.gb="true"==a?!0:"false"==a?!1:!!a);Rb(this)};m.reset=function(){};m.save=function(){return null};m.restore=function(){return!1};
m.ta=function(a,b){if(!b){if(a&&this.restore){bd(this);if(!this.restore(a))return!1;cd(this)}else this.reset();this.J?(a=this.J,a.i("Type ? for help with PCX80 Debugger commands"),nd(a),a.la&&(b=a.la,a.la=null,od(a,b))):this.i("No debugger detected")}pd(this);return!0};m.sa=function(a){return a?this.save():!0};m.gb=function(){return this.flags.gb||!this.J&&void 0===this.O.run?(this.qb(),!0):!1};m.Dc=function(){return 0};
function cd(a){void 0===a.wa&&(a.wa=0);void 0===a.la&&(a.la=-1);void 0===a.qa&&(a.qa=-1);a.flags.Ua=0<=a.wa&&0<a.la;a.flags.Ua&&(a.ua=0,a.ma=a.wa-a.ja)}function qd(a,b){if(a.flags.Ua){var c=!1;a.ua=a.ua+a.Dc()|0;a.ma-=b;0>=a.ma&&(a.ma+=a.la,c=!0);0<=a.qa&&a.qa<=rd(a)&&(a.la=a.qa=-1,cd(a),sd(a),c=!0);c&&a.i(rd(a)+" cycles: checksum="+r(a.ua))}}
m.ca=function(a,b,c){var d=this;a=!1;switch(b){case "power":case "reset":this.O[b]=c;a=!0;break;case "run":this.O[b]=c;c.onclick=function(){var e;if(e=d.P)if(e=d.P,e.flags.ha)e=!0;else{var f=null,g,h=Gb(e.id);for(g=0;g<h.length&&(f=h[g],f===e||f.flags.ready);g++);if(g==h.length)for(g=0;g<h.length&&(f=h[g],f===e||f.flags.ha);g++);g==h.length&&(f=e);v("The "+f.type+" component ("+f.id+") is not "+(f.flags.ready?"powered yet":"ready yet"+(f.xb?" (waiting for notification)":""))+".");e=!1}e&&(d.flags.ia?
sd(d):d.qb())};a=!0;break;case "speed":this.O[b]=c;a=!0;break;case "setSpeed":this.O[b]=c,c.onclick=function(){td(d,d.S<<1,!0)},c.textContent=this.Y.toFixed(2)+"Mhz",a=!0}return a};function ud(a,b,c){a.ja+=b;c&&(a.da=a.b=0)}function vd(a,b){var c=1;b&&1<a.S&&a.X&&(c=a.X/a.Ra);a.eb=Math.round(1E3/wd);a.Ka=Math.floor(a.xa/wd*c);b||(a.ra=a.Ka);a.Ta=0}function rd(a){return a.ja+a.W+a.da-a.b}function bd(a){a.X=0;a.fb=0;a.ja=a.W=a.da=a.b=0;cd(a);td(a,1)}
function td(a,b,c){var d=!1;if(void 0!==b){.8>a.X/a.Y?b=1:d=!0;a.S=b;b=a.Ra*a.S;if(a.Y!=b){a.Y=b;b=a.Y.toFixed(2)+"Mhz";var e=a.O.setSpeed;e&&(e.textContent=b);a.i("target speed: "+b)}c&&a.P&&a.P.Wa()}ud(a,a.W);a.W=0;a.U=zb();a.aa=0;vd(a);return d}function xd(a,b,c){var d=void 0===d?-1:d;var e=a.T.length;a.T.push([b,-1,d,c]);0<=d&&yd(a,e,d);return e}function yd(a,b,c){0<=b&&b<a.T.length&&(b=a.T[b],0>b[1]&&(c=a.xa*a.S/1E3*c|0,a.flags.ia&&(c+=zd(a)),b[1]=c))}
function zd(a,b){var c=a.da-=a.b;a.b=0;b&&(a.da=0);return c}
m.qb=function(a){if(Tb(this,!0)){if(!this.flags.ia){td(this);this.P&&this.P.start(this.U,rd(this));this.flags.ia=!0;this.flags.Ob=!0;this.V&&this.V.start();var b=this.O.run;b&&(b.textContent="Halt");this.P&&(Ad(this.P,!0),a&&this.P.Wa(!0))}this.Ta>=this.xa&&vd(this,!0);this.Ba=0;this.Ja=zb();this.aa&&(a=this.Ja-this.aa,a>this.eb&&(this.U+=a,this.U>this.Ja&&(this.U=this.Ja)));try{do{for(var c,d=this.flags.Ua?1:this.Ka,e=this.T.length-1;0<=e;e--){var f=this.T[e];0>f[1]||d>f[1]&&(d=f[1])}c=d;this.Bb(c);
c=zd(this,!0);this.Ba+=c;this.W+=c;qd(this,c);a=c;for(var g=this.T.length-1;0<=g;g--){var h=this.T[g];0>h[1]||(h[1]-=a,0>=h[1]&&(h[1]=-1,h[3](),0<=h[2]&&yd(this,g,h[2])))}this.ra-=c;if(0>=this.ra){this.ra+=this.Ka;++this.fb>=Bd&&(this.P&&Ad(this.P),this.fb=0);break}}while(this.flags.ia)}catch(k){sd(this);pd(this);this.P&&this.P.stop(zb(),rd(this));Tb(this,!1);Pb(this,k.stack||k.message);return}c=setTimeout;d=this.ob;this.aa=zb();e=this.eb;this.Ba&&(e=Math.round(e*this.Ba/this.Ka));e-=this.aa-this.Ja;
if(f=this.aa-this.U)this.X=Math.round(this.W/(10*f))/100,864E5<=f&&(this.ja=0,td(this));if(0>e||this.X<this.Y)-1E3>e&&(this.U-=e),e=0;this.Ta+=this.Ba;this.aa+=e;c(d,e)}else pd(this),this.P&&this.P.stop(zb(),rd(this))};m.Bb=function(){return 0};function sd(a,b){Sb(a,!0);zd(a);ud(a,a.W);a.W=0;if(a.flags.ia){a.flags.ia=!1;a.V&&a.V.stop();var c=a.O.run;c&&(c.textContent="Run")}a.flags.complete=b}function pd(a,b){if(a.P){for(var c=a.P,d=0;d<c.A.length;d++)Cd(c.A[d],b);Ad(a.P,b)}}
var wd=30,Bd=15,$c=["power","reset"];function Dd(a){var b=+a.model||8080;Zc.call(this,a,1E6);this.ub=b;this.ab=Ed;bd(this);this.flags.complete=this.flags.wd=!1;this.cb=0;this.Ia=[];this.bb=0;Fd(this)}oa(Dd,Zc);function Gd(a,b){a.Ia.push(b)}m=Dd.prototype;m.reset=function(){this.flags.ia&&sd(this);Fd(this);bd(this);this.flags.error=!1;Zc.prototype.reset.call(this)};function Fd(a){a.g=0;a.u=0;a.A=0;a.B=0;a.C=0;a.D=0;a.F=0;a.L=0;C(a,a.bb);Hd(a,0);a.R=0}function Id(a,b){a.bb=b;C(a,b)}
m.Dc=function(){var a=this.g+this.u+this.A+this.B+this.C+this.D+this.F|0;return a=a+this.L+this.j+Jd(this)|0};m.save=function(){var a=new Kd(this);a.set(0,[this.g,this.u,this.A,this.B,this.C,this.D,this.F,this.L,this.j,Jd(this)]);a.set(1,[this.R,this.ja,this.S]);a.set(2,zc(this.H));return a.data()};
m.restore=function(a){var b=a[0];this.g=b[0];this.u=b[1];this.A=b[2];this.B=b[3];this.C=b[4];this.D=b[5];this.F=b[6];this.L=b[7]&65535;C(this,b[8]);Hd(this,b[9]);b=a[1];this.R=b[0];this.ja=b[1];td(this,b[3]);a:{b=this.H;a=a[2];var c;for(c=0;c<a.length-1;c+=2){var d=a[c],e=a[c+1];if(e&&e.length<b.N){var f=b.N,g=0;f=f?Array(f):[];for(var h=0;h<e.length-1;)for(var k=e[h++],l=e[h++];k--;)f[g++]=l;e=f}g=b.b[d];if(!g||!g.restore(e)){v("Unable to restore memory block "+d);b=!1;break a}}b=!0}return b};
m.ca=function(a,b,c){switch(b){case "A":case "B":case "C":case "BC":case "D":case "E":case "DE":case "H":case "L":case "HL":case "SP":case "PC":case "PS":case "IF":case "SF":case "ZF":case "AF":case "PF":case "CF":this.O[b]=c;this.cb++;a=!0;break;default:a=Zc.prototype.ca.call(this,a,b,c)}return a};function Ld(a){return a.u<<8|a.A}function Md(a,b){a.u=b>>8&255;a.A=b&255}function Nd(a){return a.B<<8|a.C}function Od(a,b){a.B=b>>8&255;a.C=b&255}function E(a){return a.D<<8|a.F}
function Pd(a,b){a.D=b>>8&255;a.F=b&255}function C(a,b){a.j=b&65535}function Qd(a){return a.G&256?1:0}function Rd(a,b){a.G=a.G&255|b}function Sd(a){return $b[a.I&255]?4:0}function Td(a){return(a.I^a.N)&16?16:0}function Ud(a){return a.G&255?0:64}function Vd(a){return a.I&128?128:0}function Jd(a){return a.M&-214|Vd(a)|Ud(a)|Td(a)|Sd(a)|Qd(a)}function Hd(a,b){a.G=a.I=a.N=0;b&1&&(a.G|=256);b&4||(a.I|=1);b&16&&(a.N|=16);b&64||(a.G|=255);b&128&&(a.I^=192);a.M=a.M&-726|b&512|2}
function Wd(a,b){a.N=a.g^b;return a.I=(a.G=a.g+b)&255}function Xd(a,b){a.N=a.g^b;return a.I=(a.G=a.g+b+(a.G&256?1:0))&255}function Yd(a,b){a.G=a.I=a.N=a.g&b;(a.g|b)&8&&(a.N^=16);return a.G}function Zd(a,b){a.N=b^255;b=a.I=b+255&255;a.G=a.G&-256|b;return b}function $d(a,b){a.N=b;b=a.I=b+1&255;a.G=a.G&-256|b;return b}function ae(a,b){return a.I=a.G=a.N=a.g|b}function be(a,b){b^=255;a.N=a.g^b;return a.I=(a.G=a.g+b+1^256)&255}
function ce(a,b){b^=255;a.N=a.g^b;return a.I=(a.G=a.g+b+(a.G&256?0:1)^256)&255}function de(a,b){return a.I=a.G=a.N=a.g^b}function H(a,b){a=a.H;return a.b[(b&a.C)>>>a.g].Va(b&a.j,b)}function ee(a,b,c){a=a.H;a.b[(b&a.C)>>>a.g].Xa(b&a.j,c&255,b)}function I(a){var b=H(a,a.j);C(a,a.j+1);return b}function J(a){var b=mc(a.H,a.j);C(a,a.j+2);return b}function fe(a){var b=mc(a.H,a.L);a.L=a.L+2&65535;return b}function K(a,b){a.L=a.L-2&65535;pc(a.H,a.L,b)}
function ge(a){if(a.b&&a.R&255&&a.M&512){for(var b=0;8>b&&!(a.R&1<<b);b++);a.R&=~(0>b?255:1<<b);a.M&=-513;a.R&=-257;a.ab[199|b<<3].call(a)}return a.R&256?(zd(a),!1):!0}function he(a,b){a.R|=1<<b;a.M&512&&zd(a)}function L(a,b,c,d){d=d||2;a.O[b]&&(void 0===c&&(Pb(a,"Value for "+b+" is invalid"),sd(a)),c=!a.flags.ia||a.flags.Ac?r(c,d):"--------".substr(0,d),a.O[b].textContent!=c&&(a.O[b].textContent=c))}
m.Bb=function(a){this.flags.complete=!0;var b=this.flags.wd=this.J&&ie(this.J),c=a?this.flags.Ob?0:1:-1;this.flags.Ob=!1;this.da=this.b=a;if(ge(this)){do{if(b){if(je(this.J,this.j,c)){sd(this);break}c=1}this.ab[I(this)].call(this)}while(0<this.b)}return this.flags.complete?this.da-this.b:void 0===this.flags.complete?0:-1};lb(function(){for(var a=Eb(document,"pcx80","cpu"),b=0;b<a.length;b++){var c=a[b],d=Fb(c);d=new Dd(d);Db(d,c)}});function ke(){this.b-=4}
function le(){C(this,J(this));this.b-=10}function Ie(){C(this,fe(this));this.b-=10}function Je(){var a=J(this);K(this,this.j);C(this,a);this.b-=17}
var Ed=[ke,function(){Md(this,J(this));this.b-=10},function(){ee(this,Ld(this),this.g);this.b-=7},function(){Md(this,Ld(this)+1);this.b-=5},function(){this.u=$d(this,this.u);this.b-=5},function(){this.u=Zd(this,this.u);this.b-=5},function(){this.u=I(this);this.b-=7},function(){var a=this.g<<1;this.g=a&255|a>>8;Rd(this,a&256);this.b-=4},ke,function(){var a;Pd(this,a=E(this)+Ld(this));Rd(this,a>>8&256);this.b-=10},function(){this.g=H(this,Ld(this));this.b-=7},function(){Md(this,Ld(this)-1);this.b-=
5},function(){this.A=$d(this,this.A);this.b-=5},function(){this.A=Zd(this,this.A);this.b-=5},function(){this.A=I(this);this.b-=7},function(){var a=this.g<<8&256;this.g=(a|this.g)>>1;Rd(this,a);this.b-=4},ke,function(){Od(this,J(this));this.b-=10},function(){ee(this,Nd(this),this.g);this.b-=7},function(){Od(this,Nd(this)+1);this.b-=5},function(){this.B=$d(this,this.B);this.b-=5},function(){this.B=Zd(this,this.B);this.b-=5},function(){this.B=I(this);this.b-=7},function(){var a=this.g<<1;this.g=a&255|
Qd(this);Rd(this,a&256);this.b-=4},ke,function(){var a;Pd(this,a=E(this)+Nd(this));Rd(this,a>>8&256);this.b-=10},function(){this.g=H(this,Nd(this));this.b-=7},function(){Od(this,Nd(this)-1);this.b-=5},function(){this.C=$d(this,this.C);this.b-=5},function(){this.C=Zd(this,this.C);this.b-=5},function(){this.C=I(this);this.b-=7},function(){var a=this.g<<8;this.g=(Qd(this)<<8|this.g)>>1;Rd(this,a&256);this.b-=4},ke,function(){Pd(this,J(this));this.b-=10},function(){var a=J(this);pc(this.H,a,E(this));
this.b-=16},function(){Pd(this,E(this)+1);this.b-=5},function(){this.D=$d(this,this.D);this.b-=5},function(){this.D=Zd(this,this.D);this.b-=5},function(){this.D=I(this);this.b-=7},function(){var a=0,b=Qd(this);if(Td(this)||9<(this.g&15))a|=6;if(b||154<=this.g)a|=96,b=1;this.g=Wd(this,a);Rd(this,b?256:0);this.b-=4},ke,function(){var a;Pd(this,a=E(this)+E(this));Rd(this,a>>8&256);this.b-=10},function(){var a=J(this);a=mc(this.H,a);Pd(this,a);this.b-=16},function(){Pd(this,E(this)-1);this.b-=5},function(){this.F=
$d(this,this.F);this.b-=5},function(){this.F=Zd(this,this.F);this.b-=5},function(){this.F=I(this);this.b-=7},function(){this.g=~this.g&255;this.b-=4},ke,function(){this.L=J(this)&65535;this.b-=10},function(){ee(this,J(this),this.g);this.b-=13},function(){this.L=this.L+1&65535;this.b-=5},function(){var a=E(this);ee(this,a,$d(this,H(this,a)));this.b-=10},function(){var a=E(this);ee(this,a,Zd(this,H(this,a)));this.b-=10},function(){ee(this,E(this),I(this));this.b-=10},function(){this.G|=256;this.b-=
4},ke,function(){var a;Pd(this,a=E(this)+this.L);Rd(this,a>>8&256);this.b-=10},function(){this.g=H(this,J(this));this.b-=13},function(){this.L=this.L-1&65535;this.b-=5},function(){this.g=$d(this,this.g);this.b-=5},function(){this.g=Zd(this,this.g);this.b-=5},function(){this.g=I(this);this.b-=7},function(){Rd(this,Qd(this)?0:256);this.b-=4},function(){this.b-=5},function(){this.u=this.A;this.b-=5},function(){this.u=this.B;this.b-=5},function(){this.u=this.C;this.b-=5},function(){this.u=this.D;this.b-=
5},function(){this.u=this.F;this.b-=5},function(){this.u=H(this,E(this));this.b-=7},function(){this.u=this.g;this.b-=5},function(){this.A=this.u;this.b-=5},function(){this.b-=5},function(){this.A=this.B;this.b-=5},function(){this.A=this.C;this.b-=5},function(){this.A=this.D;this.b-=5},function(){this.A=this.F;this.b-=5},function(){this.A=H(this,E(this));this.b-=7},function(){this.A=this.g;this.b-=5},function(){this.B=this.u;this.b-=5},function(){this.B=this.A;this.b-=5},function(){this.b-=5},function(){this.B=
this.C;this.b-=5},function(){this.B=this.D;this.b-=5},function(){this.B=this.F;this.b-=5},function(){this.B=H(this,E(this));this.b-=7},function(){this.B=this.g;this.b-=5},function(){this.C=this.u;this.b-=5},function(){this.C=this.A;this.b-=5},function(){this.C=this.B;this.b-=5},function(){this.b-=5},function(){this.C=this.D;this.b-=5},function(){this.C=this.F;this.b-=5},function(){this.C=H(this,E(this));this.b-=7},function(){this.C=this.g;this.b-=5},function(){this.D=this.u;this.b-=5},function(){this.D=
this.A;this.b-=5},function(){this.D=this.B;this.b-=5},function(){this.D=this.C;this.b-=5},function(){this.b-=5},function(){this.D=this.F;this.b-=5},function(){this.D=H(this,E(this));this.b-=7},function(){this.D=this.g;this.b-=5},function(){this.F=this.u;this.b-=5},function(){this.F=this.A;this.b-=5},function(){this.F=this.B;this.b-=5},function(){this.F=this.C;this.b-=5},function(){this.F=this.D;this.b-=5},function(){this.b-=5},function(){this.F=H(this,E(this));this.b-=7},function(){this.F=this.g;
this.b-=5},function(){ee(this,E(this),this.u);this.b-=7},function(){ee(this,E(this),this.A);this.b-=7},function(){ee(this,E(this),this.B);this.b-=7},function(){ee(this,E(this),this.C);this.b-=7},function(){ee(this,E(this),this.D);this.b-=7},function(){ee(this,E(this),this.F);this.b-=7},function(){var a=this.j-1;if(this.Ia.length)for(var b=0;b<this.Ia.length;b++)if(this.Ia[b](a))return;this.b-=7;this.R|=256;zd(this);this.J&&Ub(this,536870912)?(C(this,a),Yc(this.J)):this.M&512||(this.J&&C(this,a),sd(this))},
function(){ee(this,E(this),this.g);this.b-=7},function(){this.g=this.u;this.b-=5},function(){this.g=this.A;this.b-=5},function(){this.g=this.B;this.b-=5},function(){this.g=this.C;this.b-=5},function(){this.g=this.D;this.b-=5},function(){this.g=this.F;this.b-=5},function(){this.g=H(this,E(this));this.b-=7},function(){this.b-=5},function(){this.g=Wd(this,this.u);this.b-=4},function(){this.g=Wd(this,this.A);this.b-=4},function(){this.g=Wd(this,this.B);this.b-=4},function(){this.g=Wd(this,this.C);this.b-=
4},function(){this.g=Wd(this,this.D);this.b-=4},function(){this.g=Wd(this,this.F);this.b-=4},function(){this.g=Wd(this,H(this,E(this)));this.b-=7},function(){this.g=Wd(this,this.g);this.b-=4},function(){this.g=Xd(this,this.u);this.b-=4},function(){this.g=Xd(this,this.A);this.b-=4},function(){this.g=Xd(this,this.B);this.b-=4},function(){this.g=Xd(this,this.C);this.b-=4},function(){this.g=Xd(this,this.D);this.b-=4},function(){this.g=Xd(this,this.F);this.b-=4},function(){this.g=Xd(this,H(this,E(this)));
this.b-=7},function(){this.g=Xd(this,this.g);this.b-=4},function(){this.g=be(this,this.u);this.b-=4},function(){this.g=be(this,this.A);this.b-=4},function(){this.g=be(this,this.B);this.b-=4},function(){this.g=be(this,this.C);this.b-=4},function(){this.g=be(this,this.D);this.b-=4},function(){this.g=be(this,this.F);this.b-=4},function(){this.g=be(this,H(this,E(this)));this.b-=7},function(){this.g=be(this,this.g);this.b-=4},function(){this.g=ce(this,this.u);this.b-=4},function(){this.g=ce(this,this.A);
this.b-=4},function(){this.g=ce(this,this.B);this.b-=4},function(){this.g=ce(this,this.C);this.b-=4},function(){this.g=ce(this,this.D);this.b-=4},function(){this.g=ce(this,this.F);this.b-=4},function(){this.g=ce(this,H(this,E(this)));this.b-=7},function(){this.g=ce(this,this.g);this.b-=4},function(){this.g=Yd(this,this.u);this.b-=4},function(){this.g=Yd(this,this.A);this.b-=4},function(){this.g=Yd(this,this.B);this.b-=4},function(){this.g=Yd(this,this.C);this.b-=4},function(){this.g=Yd(this,this.D);
this.b-=4},function(){this.g=Yd(this,this.F);this.b-=4},function(){this.g=Yd(this,H(this,E(this)));this.b-=7},function(){this.g=Yd(this,this.g);this.b-=4},function(){this.g=de(this,this.u);this.b-=4},function(){this.g=de(this,this.A);this.b-=4},function(){this.g=de(this,this.B);this.b-=4},function(){this.g=de(this,this.C);this.b-=4},function(){this.g=de(this,this.D);this.b-=4},function(){this.g=de(this,this.F);this.b-=4},function(){this.g=de(this,H(this,E(this)));this.b-=7},function(){this.g=de(this,
this.g);this.b-=4},function(){this.g=ae(this,this.u);this.b-=4},function(){this.g=ae(this,this.A);this.b-=4},function(){this.g=ae(this,this.B);this.b-=4},function(){this.g=ae(this,this.C);this.b-=4},function(){this.g=ae(this,this.D);this.b-=4},function(){this.g=ae(this,this.F);this.b-=4},function(){this.g=ae(this,H(this,E(this)));this.b-=7},function(){this.g=ae(this,this.g);this.b-=4},function(){be(this,this.u);this.b-=4},function(){be(this,this.A);this.b-=4},function(){be(this,this.B);this.b-=4},
function(){be(this,this.C);this.b-=4},function(){be(this,this.D);this.b-=4},function(){be(this,this.F);this.b-=4},function(){be(this,H(this,E(this)));this.b-=7},function(){be(this,this.g);this.b-=4},function(){Ud(this)||(C(this,fe(this)),this.b-=6);this.b-=5},function(){Md(this,fe(this));this.b-=10},function(){var a=J(this);Ud(this)||C(this,a);this.b-=10},le,function(){var a=J(this);Ud(this)||(K(this,this.j),C(this,a),this.b-=6);this.b-=11},function(){K(this,Ld(this));this.b-=11},function(){this.g=
Wd(this,I(this));this.b-=7},function(){K(this,this.j);C(this,0);this.b-=11},function(){Ud(this)&&(C(this,fe(this)),this.b-=6);this.b-=5},Ie,function(){var a=J(this);Ud(this)&&C(this,a);this.b-=10},le,function(){var a=J(this);Ud(this)&&(K(this,this.j),C(this,a),this.b-=6);this.b-=11},Je,function(){this.g=Xd(this,I(this));this.b-=7},function(){K(this,this.j);C(this,8);this.b-=11},function(){Qd(this)||(C(this,fe(this)),this.b-=6);this.b-=5},function(){Od(this,fe(this));this.b-=10},function(){var a=J(this);
Qd(this)||C(this,a);this.b-=10},function(){var a=I(this);Gc(this.H,a,this.g,this.j+-2&65535);this.b-=10},function(){var a=J(this);Qd(this)||(K(this,this.j),C(this,a),this.b-=6);this.b-=11},function(){K(this,Nd(this));this.b-=11},function(){this.g=be(this,I(this));this.b-=7},function(){K(this,this.j);C(this,16);this.b-=11},function(){Qd(this)&&(C(this,fe(this)),this.b-=6);this.b-=5},Ie,function(){var a=J(this);Qd(this)&&C(this,a);this.b-=10},function(){var a=I(this);this.g=Cc(this.H,a,this.j+-2&65535)&
255;this.b-=10},function(){var a=J(this);Qd(this)&&(K(this,this.j),C(this,a),this.b-=6);this.b-=11},Je,function(){this.g=ce(this,I(this));this.b-=7},function(){K(this,this.j);C(this,24);this.b-=11},function(){Sd(this)||(C(this,fe(this)),this.b-=6);this.b-=5},function(){Pd(this,fe(this));this.b-=10},function(){var a=J(this);Sd(this)||C(this,a);this.b-=10},function(){var a=fe(this);K(this,E(this));Pd(this,a);this.b-=18},function(){var a=J(this);Sd(this)||(K(this,this.j),C(this,a),this.b-=6);this.b-=
11},function(){K(this,E(this));this.b-=11},function(){this.g=Yd(this,I(this));this.b-=7},function(){K(this,this.j);C(this,32);this.b-=11},function(){Sd(this)&&(C(this,fe(this)),this.b-=6);this.b-=5},function(){C(this,E(this));this.b-=5},function(){var a=J(this);Sd(this)&&C(this,a);this.b-=10},function(){var a=E(this);Pd(this,Nd(this));Od(this,a);this.b-=5},function(){var a=J(this);Sd(this)&&(K(this,this.j),C(this,a),this.b-=6);this.b-=11},Je,function(){this.g=de(this,I(this));this.b-=7},function(){K(this,
this.j);C(this,40);this.b-=11},function(){Vd(this)||(C(this,fe(this)),this.b-=6);this.b-=5},function(){var a=fe(this);Hd(this,a&255|this.M&-256);this.g=a>>8;this.b-=10},function(){var a=J(this);Vd(this)||C(this,a);this.b-=10},function(){this.M&=-513;this.b-=4},function(){var a=J(this);Vd(this)||(K(this,this.j),C(this,a),this.b-=6);this.b-=11},function(){K(this,Jd(this)&255|this.g<<8);this.b-=11},function(){this.g=ae(this,I(this));this.b-=7},function(){K(this,this.j);C(this,48);this.b-=11},function(){Vd(this)&&
(C(this,fe(this)),this.b-=6);this.b-=5},function(){this.L=E(this)&65535;this.b-=5},function(){var a=J(this);Vd(this)&&C(this,a);this.b-=10},function(){this.M|=512;this.b-=4;ge(this)},function(){var a=J(this);Vd(this)&&(K(this,this.j),C(this,a),this.b-=6);this.b-=11},Je,function(){be(this,I(this));this.b-=7},function(){K(this,this.j);C(this,56);this.b-=11}];
function Ke(a){x.call(this,"ChipSet",a,64);var b=a.model;b&&!Le[b]&&ob("Unrecognized ChipSet model: "+b);this.g=Le[b]||{};a.sound&&(this.T=null,window&&(this.T=window.AudioContext||window.webkitAudioContext),this.T&&new this.T);Rb(this)}oa(Ke,x);m=Ke.prototype;m.ca=function(){return!1};
m.Da=function(a,b,c,d){this.H=b;this.w=c;this.J=d;this.P=a;this.B=cc(a,"Keyboard");this.C=cc(a,"SerialPort");this.video=cc(a,"Video");Bc(b,this,this.g.zb);Fc(b,this,this.g.Ab);if(d){var e=this;Me(d,32,function(){for(var f="",g=0;g<e.j.length;g++)f&&(f+=g&&g%10?", ":",\n"),f+=t(e.j[g]);e.J.i(f)})}};m.ta=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};m.sa=function(a){return a?this.save():!0};m.reset=function(){this.g.INIT&&!this.restore(this.g.INIT)&&this.Z("reset error")};
m.save=function(){var a=new Kd(this);switch(this.g.na){case Ne.na:a.set(0,[this.aa,this.A,this.da,this.M,this.S,this.X,this.Y]);break;case M.na:a.set(0,[this.V,this.D]),a.set(1,[this.F,this.G]),a.set(2,[this.u,this.N,this.W,this.U]),a.set(3,[this.L,this.b,this.I,this.R,this.j])}return a.data()};
m.restore=function(a){var b;if(a&&(b=a[0])&&b.length)switch(this.g.na){case Ne.na:return this.aa=b[0],this.A=b[1],this.da=b[2],this.M=b[3],this.S=b[4],this.X=b[5],this.Y=b[6],!0;case M.na:return this.V=b[0],this.D=b[1],b=a[1],this.F=b[0],this.G=b[1],b=a[2],this.u=b[0],this.N=b[1],this.W=b[2],this.U=b[3],b=a[3],this.L=b[0],this.b=b[1],this.I=b[2],this.R=b[3],this.j=b[4],!0}return!1};m.start=function(){};m.stop=function(){};m.Id=function(a,b){var c=this.aa;A(this,a,void 0,b,"STATUS0",c,!0);return c};
m.Jd=function(a,b){var c=this.A;A(this,a,void 0,b,"STATUS1",c,!0);return c};m.Kd=function(a,b){var c=this.da;A(this,a,void 0,b,"STATUS2",c,!0);return c};m.Hd=function(a,b){var c=this.M>>8-this.S&255;A(this,a,void 0,b,"SHIFT.RESULT",c,!0);return c};m.Vd=function(a,b,c){A(this,a,b,c,"SHIFT.COUNT",void 0,!0);this.S=b};m.Xd=function(a,b,c){A(this,a,b,c,"SOUND1",void 0,!0);this.X=b};m.Wd=function(a,b,c){A(this,a,b,c,"SHIFT.DATA",void 0,!0);this.M=b<<8|this.M>>8};
m.Yd=function(a,b,c){A(this,a,b,c,"SOUND2",void 0,!0);this.Y=b};m.Zd=function(a,b,c){A(this,a,b,c,"WATCHDOG",void 0,!0)};function Oe(a){var b=0,c=0,d=~a.L;for(a=0;10>a;a++)d&1&&(b=9-a),d>>=1;for(a=0;10>a;a++)d&1&&(c=9-a),d>>=1;return 10*b+c}
m.Ld=function(a,b){var c=this.D;c&=~M.va.ic;if((rd(this.w)&64)<<1&&(c|=M.va.ic,c!=this.D)){var d=this.I&1;var e=this.I>>1&7;switch(e){case M.ya.Ga.md:break;case M.ya.Ga.Kc:this.L=this.L<<1|d;break;case M.ya.Ga.Qc:d=Oe(this);this.j[d]=M.ya.sb;Vb(this,"doNVRCommand(): erase data at addr "+t(d));break;case M.ya.Ga.Lc:this.b=this.b<<1|d;break;case M.ya.Ga.qd:d=Oe(this);e=this.b&M.ya.sb;this.j[d]=e;Vb(this,"doNVRCommand(): write data "+t(e)+" to addr "+t(d));break;case M.ya.Ga.kd:d=Oe(this);e=this.j[d];
null==e&&(e=M.ya.sb);this.b=e;Vb(this,"doNVRCommand():  read data "+t(e)+" from addr "+t(d));break;case M.ya.Ga.ld:this.b<<=1;this.R=this.b&M.ya.sb+1;break;default:Vb(this,"doNVRCommand(): unrecognized command "+za(e))}}c&=~M.va.jc;this.R&&(c|=M.va.jc);c&=~M.va.cc;if(d=this.B){d=this.B;if(e=d.A)e=d.w,e=rd(d.w)>=d.F+(e.xa*e.S/1E3*1.2731488|0);e&&(d.A=!1);d=!d.A}d&&(c|=M.va.cc);c&=~M.va.rc;this.C&&this.C.ga&Pe&&(c|=M.va.rc);this.D=c;A(this,a,void 0,b,"FLAGS",c);return c};
m.$d=function(a,b,c){A(this,a,b,c,"BRIGHTNESS");this.V=b};m.ce=function(a,b,c){A(this,a,b,c,"NVR.LATCH");this.I=b};m.be=function(a,b,c){A(this,a,b,c,"DC012");a=b&3;switch(b>>2&3){case 0:this.u=this.u&-4|a;break;case 1:this.u=this.u&-13|a<<2;this.video&&(b=this.video,a=this.u,Vb(b,"updateScrollOffset("+a+")"),b.qa!==a&&((b.qa=a)?Cd(b,!0):b.ua=!0));break;case 2:switch(a){case 0:this.N=~this.N;break;case 2:case 3:this.W=3-a}break;case 3:this.U=a}};
m.ae=function(a,b,c){A(this,a,b,c,"DC011");b&M.Ha.jd?(b&=M.Ha.nc,this.G!=b&&(this.G=b,this.video&&(a=this.video,b=this.G==M.Ha.nc?50:60,Vb(a,"updateRate("+b+")"),a.fb=b))):(b&=M.Ha.Vb,this.F!=b&&(this.F=b,this.video&&(a=this.F==M.Ha.Vb?132:80,b=this.video,Vb(b,"updateDimensions("+a+","+(80<a&&this.D&M.va.hc?14:24)+")"),b.N=a,b.ea=b.Ba,80<a&&b.ea--,Qe(b)&&Re(b))))};
var Ne={na:1978.1,od:{oa:0,ff:1,lf:16,tf:32,Cf:64,Bf:128,Za:14},La:{oa:1,Oc:1,hd:2,dd:4,ed:16,fd:32,gd:64,Za:8},pd:{oa:2,ef:3,Kf:4,gf:8,xf:16,yf:32,zf:64,hf:128,Za:0},Gf:{oa:3},Ef:{oa:2,uf:7},If:{oa:3,Lf:1,Hf:2,Af:4,rf:8,kf:16,Ae:32},Ff:{oa:4},Jf:{oa:5,mf:1,nf:2,pf:4,qf:8,Mf:16}},M={na:100,va:{oa:66,rc:1,hc:2,cd:4,wf:8,vf:16,jc:32,ic:64,cc:128},Nc:{oa:66,INIT:0},Ha:{oa:194,De:0,Vb:16,jd:32,nc:48,Tc:0,Uc:32},rb:{oa:162,Df:0,Wc:0,Sc:0,Vc:0,Rc:0},ya:{sf:{oa:98},Ga:{Lc:0,Kc:1,ld:2,qd:4,Qc:5,kd:6,md:7},
sb:16383}},Le={SI1978:Ne,VT100:M};Ne.INIT=[[Ne.od.Za,Ne.La.Za,Ne.pd.Za,0,0,0,0]];
M.INIT=[[M.Nc.INIT,M.va.hc|M.va.cd],[M.Ha.Tc,M.Ha.Uc],[M.rb.Wc,M.rb.Sc,M.rb.Vc,M.rb.Rc],[0,0,0,0,[11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11776,11784,11918,11776,11984,11888,11776,11808,11776,12E3,12E3,11901,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11776,11784,11918,11808,11984,11856,11776,11808,11776,12E3,12E3,11881,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]];Ne.zb={0:Ke.prototype.Id,1:Ke.prototype.Jd,2:Ke.prototype.Kd,3:Ke.prototype.Hd};
Ne.Ab={2:Ke.prototype.Vd,3:Ke.prototype.Xd,4:Ke.prototype.Wd,5:Ke.prototype.Yd,6:Ke.prototype.Zd};M.zb={66:Ke.prototype.Ld};M.Ab={66:Ke.prototype.$d,98:Ke.prototype.ce,162:Ke.prototype.be,194:Ke.prototype.ae};lb(function(){for(var a=Eb(document,"pcx80","chipset"),b=0;b<a.length;b++){var c=a[b],d=Fb(c);d=new Ke(d);Db(d,c)}});
function Se(a){x.call(this,"ROM",a);this.b=null;this.A=a.addr;this.g=a.size;this.u=a.alias;this.j=a.file;this.B=Aa(this.j);if(this.j){a=this.j;var b=Ba(this.B);"json"!=b&&"hex"!=b&&(a=Ua()+"/api/v1/dump?file="+this.j+"&format=bytes&decimal=true");var c=this;Sa(a,null,!0,function(d,e,f){Te(c,d,e,f)})}}oa(Se,x);Se.prototype.Da=function(a,b,c,d){this.H=b;this.w=c;this.J=d;Ue(this)};
Se.prototype.ta=function(){if(this.pa){if(this.J){var a=this.J,b=this.id,c=this.A,d=this.g,e=this.pa,f=[],g;for(g in e){var h=e[g];"number"==typeof h&&(e[g]=h={o:h});var k=h.o,l=h.a;if(void 0!==k){var p=f;k=[k>>>0,g];var u=Pa(p,k,a.zc);0>u&&p.splice(-(u+1),0,k)}l&&(h.a=l.replace(/''/g,'"'))}a.C.push({Pf:b,K:c,Pd:d,pa:e,xc:f})}delete this.pa}return!0};Se.prototype.sa=function(){return!0};
function Te(a,b,c,d){if(d)a.Z("Unable to load system ROM (error "+d+": "+b+")");else{xb(a.Pa,b,c);if("["==c.charAt(0)||"{"==c.charAt(0))try{var e=eval("("+c+")"),f=e.bytes,g=e.longs||e.data;if(f)a.b=f;else if(g)for(a.b=Array(4*g.length),d=c=0;c<g.length;c++)a.b[d++]=g[c]&255,a.b[d++]=g[c]>>8&255,a.b[d++]=g[c]>>16&255,a.b[d++]=g[c]>>24&255;else a.b=e;a.pa=e.symbols;if(!a.b.length){v("Empty ROM: "+b);return}if(1==a.b.length){v(a.b[0]);return}}catch(h){a.Z("ROM data error: "+h.message);return}else for(b=
c.replace(/\n/gm," ").replace(/ +$/,"").split(" "),a.b=Array(b.length),e=0;e<b.length;e++)a.b[e]=wa(b[e],16);Ue(a)}}
function Ue(a){if(!Qb(a))if(!a.j)Rb(a);else if(a.b&&a.H){a.g||(a.g=a.b.length);if(a.b.length!=a.g)Pb(a,"ROM size ("+r(a.b.length,8,!0)+") does not match specified size ("+r(a.g,8,!0)+")");else{var b=a.A;if(gc(a.H,b,a.g,Nc)){var c;for(c=0;c<a.b.length;c++)oc(a.H,b+c,a.b[c]);b=!0}else b=!1;if(b){b=[];"number"==typeof a.u?b.push(a.u):null!=a.u&&a.u.length&&(b=a.u);for(c=0;c<b.length;c++){for(var d=a,e=b[c],f=d.H,g=d.g,h=[],k=d.A>>>f.g;0<g&&k<f.b.length;)h.push(f.b[k++]),g-=f.u;f=d.H;d=d.g;g=0;for(e>>>=
f.g;0<d&&e<f.b.length;){k=h[g++];if(!k)break;f.b[e++]=k;d-=f.u}}delete a.b}}Rb(a)}}lb(function(){for(var a=Eb(document,"pcx80","rom"),b=0;b<a.length;b++){var c=a[b],d=Fb(c);d=new Se(d);Db(d,c)}});
function Ve(a){x.call(this,"RAM",a);this.pa=this.g=null;this.u=a.addr;this.A=a.size;this.Na=a.load;this.Fa=a.exec;this.j=!1;this.b=a.file;this.B=Aa(this.b);if(this.b){a=this.b;var b=Ba(this.B);"json"!=b&&"hex"!=b&&(a=Ua()+"/api/v1/dump?file="+this.b+"&format=bytes&decimal=true");var c=this;Sa(a,null,!0,function(d,e,f){f?c.Z("Unable to load RAM resource (error "+f+": "+d+")"):(xb(c.Pa,d,e),(d=Va(d,e))?(c.g=d.ka,c.pa=d.pa,null==c.Na&&(c.Na=d.Na),null==c.Fa&&(c.Fa=d.Fa)):c.b=null,We(c))})}}oa(Ve,x);
Ve.prototype.Da=function(a,b,c,d){this.H=b;this.w=c;this.J=d;We(this)};Ve.prototype.ta=function(){return!0};Ve.prototype.sa=function(){return!0};
function We(a){!a.j&&a.A&&gc(a.H,a.u,a.A,1)&&(a.j=!0);if(!Qb(a)){if(!a.j)v("No RAM allocated");else if(a.b){if(!a.g||!a.H)return;var b=a.u;null!==a.Na&&(b=a.Na);for(var c=0;c<a.g.length;c++)oc(a.H,b+c,a.g[c]);if(null!==a.Fa){if(a.Fa==Xe){for(c=0;c<Ye.length;c++)oc(a.H,Ye[c],118);Gd(a.w,function(d){return function(e){if(0<=Ye.indexOf(e)){var f=!1,g=d.w,h=d.J;if(e==Ze)switch(f=!0,g.A){case $e:d.print(String.fromCharCode(g.C).replace(/\r/g,""));break;case af:for(var k=Nd(g),l="",p=255;p--;){var u=H(d.w,
k++);if(36==u)break;l+=String.fromCharCode(u)}d.print(l.replace(/\r/g,""));break;default:f=!1}f?Ie.call(g):h&&(d.i("\nCP/M vector "+t(e)),C(g,e),Yc(h));e=!0}else e=!1;return e}}(a))}Id(a.w,a.Fa)}delete a.g}Rb(a)}}Ve.prototype.reset=function(){};var Ze=5,$e=2,af=9,Xe=256,Ye=[0,Ze];lb(function(){for(var a=Eb(document,"pcx80","ram"),b=0;b<a.length;b++){var c=a[b],d=Fb(c);d=new Ve(d);Db(d,c)}});
function bf(a){x.call(this,"Keyboard",a,128);(a=a.model)&&!cf[a]&&ob("Unrecognized KeyboardX80 model: "+a);this.b=cf[a]||{};this.reset();Rb(this)}oa(bf,x);m=bf.prototype;
m.ca=function(a,b,c){var d=this,e=a+"-"+b;if(void 0===this.O[e]){if("led"==a&&this.b.$a[b])return this.O[e]=c,!0;switch(b){case "kbd":case "screen":return ab("iOS")?(c.onkeypress=function(f){var g=!1;if(f=d.b.pb[f.keyCode||f.charCode]){f&128&&(f&=127,g=!0);a:{for(h in d.b.Qa)if(d.b.Qa[h]==f){var h=+h;break a}h=0}h&&(g?df(d,16,!0,!0):df(d,16,!1),df(d,h,!0,!0))}return!0},c.onkeydown=function(f){return ef(d,f,!0)},c.onkeyup=function(f){return ef(d,f,!1)}):(c.onkeydown=function(f){return ff(d,f,!0)},
c.onkeyup=function(f){return ff(d,f,!1)},c.onkeypress=function(f){f=f.keyCode||f.charCode;f>=n.Ya&&f<=n.tb?d.g&(gf|hf)||(d.g|=hf,df(d,20,!0),jf(d)):f>=n.vb&&f<=n.z&&d.g&hf&&(d.g&=~hf,df(d,20,!1),jf(d));return!0}),c.onpaste=function(f){a:{if(d.C&&d.C.Oa&&(f.stopPropagation&&f.stopPropagation(),f.preventDefault&&f.preventDefault(),f=f.clipboardData||window.clipboardData)){kf(d.C,f.getData("Text"));f=!1;break a}f=!0}return f},!0;default:if(this.b.Sa&&void 0!==this.b.Sa[b])return this.O[e]=c,c.onclick=
function(f,g){return function(h){h.preventDefault&&h.preventDefault();h=!0;var k=0;17==g?k=lf:20==g&&(k=hf);if(k){c.style.fontWeight="normal";if(h=!(f.g&k))c.style.fontWeight="bold";mf(f,g,h)}df(f,g,h,!k);f.P&&f.P.Wa()}}(this,this.b.Sa[b]),!0}}return!1};m.Da=function(a,b,c,d){this.P=a;this.w=c;this.J=d;var e=this;this.I=xd(this.w,this.id,function(){nf(e)});this.V=cc(a,"ChipSet");this.C=cc(a,"SerialPort");Bc(b,this,this.b.zb);Fc(b,this,this.b.Ab)};
m.ta=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};m.sa=function(a){return a?this.save():!0};m.reset=function(){this.j=[];this.g=0;this.b.INIT&&!this.restore(this.b.INIT)&&this.Z("reset error")};m.save=function(){var a=new Kd(this);switch(this.b.na){case N.na:a.set(0,[this.D,this.B,this.A,this.F,-1])}return a.data()};
m.restore=function(a){var b;if(a&&(b=a[0])&&b.length)switch(this.b.na){case of.na:return!0;case N.na:return this.D=b[0],jf(this,this.D&N.za.dc),this.B=b[1],this.A=b[2],this.F=b[3],this.u=b[4],!0}return!1};function jf(a,b){null!=b?a.G=b:b=a.G;for(var c in a.b.$a){var d="led-"+c;if(d=a.O[d]){var e=a.b.$a[c],f=!!(b&e);e&e-1&&(f=!(b&~e));d.style.backgroundColor=f?"#"+r(16711680,6):"#000000"}}if(d=a.O["led-caps-lock"])d.style.backgroundColor=a.g&hf?"#"+r(65280,6):"#000000"}
function mf(a,b,c,d){var e=0;switch(b){case 16:e=d?pf:qf;break;case 17:e=d?rf:lf;break;case 18:e=d?sf:tf;break;case 91:e=d?uf:vf;break;case 20:e=hf,c=!(a.g&e)}e&&(a.g=c?a.g|e:a.g&~e);return c}
function ff(a,b,c){var d=!0,e=b.keyCode;e=ua[e]||e;c=mf(a,e,c,2==b.location);a:if(e=a.b.Sb[e]||e,a.b.Qa[e])var f=e;else{for(f in a.b.Sa)if(a.b.Sa[f]===e)break a;f=null}f&&!b.metaKey&&(d=!1,a.g&(wf|xf)&&(13==f?(f=118,d=!0):8==f&&(f=46,d=!0),d&&(a.g=c?a.g|xf:a.g&~xf)),d=df(a,f,c),(!(f>=n.Ya&&f<=n.tb)||a.g|yf)&&b.preventDefault&&b.preventDefault());return d}
function ef(a,b,c){var d=!0;if(c){var e=b.keyCode,f=a.b.Qa[e],g;if(g=f){a:{for(var h in a.b.pb)if(a.b.pb[h]==f){f=+h;break a}f=0}g=!f}g&&(d=df(a,e,c,!0),b.preventDefault&&b.preventDefault())}return d}
function df(a,b,c,d){var e;a:{for(e=0;e<a.j.length;e++)if(a.j[e].Nb==b)break a;e=-1}if(c)0>e?a.j.push({Nb:b,Kb:Date.now(),wb:d||!1}):(a.j[e].Kb=Date.now(),a.j[e].wb=d||!1),d&&nf(a);else if(0<=e){if(!a.j[e].wb&&(d=a.j[e].Kb)&&Date.now()-d<zf)return a.j[e].wb=!0,nf(a),!0;a.j.splice(e,1)}if(a.V){d=0;switch(b){case "1p":d=Ne.La.dd;break;case "2p":d=Ne.La.hd;break;case "coin":d=Ne.La.Oc;break;case "left":d=Ne.La.fd;break;case "right":d=Ne.La.gd;break;case "fire":d=Ne.La.ed}d&&(a=a.V,b=d,a.A&=~b,c&&(a.A|=
b))}return!0}function nf(a){for(var b=0,c=-1;b<a.j.length;){if(a.j[b].wb){var d=a.j[b].Nb,e=zf-(Date.now()-a.j[b].Kb);if(0<e){if(0>c||c>e)c=e}else{df(a,d,!1);b=0;continue}}b++}0<=c&&yd(a.w,a.I,c)}m.Md=function(a,b){var c=this.B;0<=this.u&&(this.u<this.j.length?(c=this.j[this.u],this.u++,c=N.Qa[c.Nb],c&128&&(c&=127)):(this.u=-1,c=N.Xc),this.B=c,he(this.w,1));A(this,a,void 0,b,"KBDUART.ADDRESS",c);return c};
m.de=function(a,b,c){A(this,a,b,c,"KBDUART.STATUS");this.D=b;this.A=!0;this.F=rd(this.w);jf(this,b&N.za.dc);b&N.za.nd&&(this.u=0,he(this.w,1))};var pf=1,qf=2,gf=3,rf=4,lf=8,yf=12,sf=16,tf=32,wf=48,uf=64,vf=128,hf=512,xf=4096,zf=50,Af={};Af[n.Ya]=37;Af[n.Cb]=39;Af[n.Eb]=32;
var of={na:1978.1,Qa:{},pb:{},Sb:Af,$a:{},Sa:{"1p":49,"2p":50,coin:51,left:37,right:39,fire:32}},O={},P={},N={na:100,Qa:(O[8]=3,O[n.lc]=5,O[n.kc]=6,O[n.wc]=7,O[n.pc]=8,O[n.tc]=9,O[n.Q]=10,O[39]=16,O[221]=20,O[219]=21,O[n.$b]=22,O[n.qc]=23,O[n.mc]=24,O[n.E]=25,O[49]=26,O[37]=32,O[40]=34,O[117]=35,O[19]=35,O[192]=36,O[189]=37,O[57]=38,O[55]=39,O[52]=40,O[51]=41,O[27]=42,O[38]=48,O[114]=49,O[112]=50,O[46]=51,O[187]=52,O[48]=53,O[56]=54,O[54]=55,O[53]=56,O[50]=57,O[9]=58,O[103]=64,O[115]=65,O[113]=66,
O[96]=67,O[118]=68,O[220]=69,O[n.Eb]=70,O[n.bc]=71,O[n.Yb]=72,O[n.Xb]=73,O[n.Ya]=74,O[104]=80,O[2013]=81,O[98]=82,O[97]=83,O[222]=85,O[186]=86,O[n.ac]=87,O[n.Zb]=88,O[n.Cb]=89,O[n.oc]=90,O[110]=96,O[116]=97,O[101]=98,O[100]=99,O[13]=100,O[190]=101,O[188]=102,O[n.gc]=103,O[n.Tb]=104,O[n.vc]=105,O[119]=106,O[105]=112,O[99]=113,O[102]=114,O[109]=115,O[191]=117,O[n.fc]=118,O[n[" "]]=119,O[n.sc]=120,O[n.Ub]=121,O[n.tb]=122,O[120]=123,O[17]=124,O[16]=125,O[20]=126,O),pb:(P[n.p]=5,P[n.Rd]=6,P[n.y]=7,P[n.t]=
8,P[n.re]=9,P[n.q]=10,P[n["]"]]=20,P[n["["]]=21,P[n.Ed]=22,P[n.pe]=23,P[n.r]=24,P[n.e]=25,P[n["1"]]=26,P[n["`"]]=36,P[n["-"]]=37,P[n["9"]]=38,P[n["7"]]=39,P[n["4"]]=40,P[n["3"]]=41,P[n["="]]=52,P[n["0"]]=53,P[n["8"]]=54,P[n["6"]]=55,P[n["5"]]=56,P[n["2"]]=57,P[n["\\"]]=69,P[n.Od]=70,P[n.k]=71,P[n.Ad]=72,P[n.yd]=73,P[n.vb]=74,P[n["'"]]=85,P[n[";"]]=86,P[n.Nd]=87,P[n.Cd]=88,P[n.d]=89,P[n.ne]=90,P[13]=100,P[n["."]]=101,P[n[","]]=102,P[n.n]=103,P[n.sd]=104,P[n.x]=105,P[n["/"]]=117,P[n.Qd]=118,P[n.qe]=
120,P[n.ud]=121,P[n.z]=122,P[n.lc]=133,P[n.kc]=134,P[n.wc]=135,P[n.pc]=136,P[n.tc]=137,P[n.Q]=138,P[n["}"]]=148,P[n["{"]]=149,P[n.$b]=150,P[n.qc]=151,P[n.mc]=152,P[n.E]=153,P[n["!"]]=154,P[n["~"]]=164,P[n._]=165,P[n["("]]=166,P[n["&"]]=167,P[n.$]=168,P[n["#"]]=169,P[n["+"]]=180,P[n[")"]]=181,P[n["*"]]=182,P[n["^"]]=183,P[n["%"]]=184,P[n["@"]]=185,P[n["|"]]=197,P[n.Eb]=198,P[n.bc]=199,P[n.Yb]=200,P[n.Xb]=201,P[n.Ya]=202,P[n['"']]=213,P[n[":"]]=214,P[n.ac]=215,P[n.Zb]=216,P[n.Cb]=217,P[n.oc]=218,P[n[">"]]=
229,P[n["<"]]=230,P[n.gc]=231,P[n.Tb]=232,P[n.vc]=233,P[n["?"]]=245,P[n.fc]=246,P[n.sc]=248,P[n.Ub]=249,P[n.tb]=250,P),Sb:{},$a:{},Sa:{"caps-lock":20,ctrl:17,esc:27,tab:9,"num-comma":116,"break":117,"line-feed":118,"no-scroll":119,setup:120},Mc:{oa:130,INIT:127},za:{oa:130,ad:1,$c:2,Zc:4,Yc:8,bd:16,ec:32,dc:63,nd:64,Ce:128,INIT:0},Xc:127};N.$a={l4:N.za.ad,l3:N.za.$c,l2:N.za.Zc,l1:N.za.Yc,locked:N.za.bd,local:N.za.ec,online:~N.za.ec,"caps-lock":hf};var cf={SI1978:of,VT100:N};
N.INIT=[[N.za.INIT,N.Mc.INIT,!1,0,-1]];N.zb={130:bf.prototype.Md};N.Ab={130:bf.prototype.de};lb(function(){for(var a=Eb(document,"pcx80","keyboard"),b=0;b<a.length;b++){var c=a[b],d=Fb(c);d=new bf(d);Db(d,c)}});
function Bf(a,b,c,d,e){x.call(this,"Video",a,512);var f=this;this.Ra=ab("Gecko/");this.L=a.screenWidth;this.G=a.screenHeight;this.ja=a.bufferAddr;this.xd=a.bufferRAM;var g=a.bufferFormat;this.X=g&&Cf[g.toUpperCase()]||Df;this.N=a.bufferCols;this.Y=a.bufferRows;this.Ba=this.ea=a.cellWidth||1;this.ba=a.cellHeight||1;this.aa=null;this.Ka=!1;this.la=a.bufferBits||1;this.zd=a.bufferLeft||0;if(this.g=a.bufferRotate)this.g=this.g%360,0<this.g&&(this.g-=360),-90!=this.g&&(this.Z("unsupported buffer rotation: "+
this.g),this.g=0);this.ma=a.interruptRate;this.ub=a.refreshRate||60;this.F=b;this.j=c;this.U=(this.Dd=d)||b||null;this.td=this.L;this.vd=this.G;this.Ia=this.L/this.N|0;this.Ja=this.G/this.Y|0;1<this.ba&&(this.Y++,this.qa=0,this.ua=!1);b=a.smoothing;(c=gb("smoothing"))&&(b="true"==c);this.Ta=b;this.ob=bb(this.j,"imageSmoothingEnabled");if(this.u=a.screenRotate)this.u=this.u%360,0<this.u&&(this.u-=360),-90!=this.u?(this.Z("unsupported screen rotation: "+this.u),this.u=0):(this.j.translate(0,this.G),
this.j.rotate(this.u*Math.PI/180),this.j.scale(this.G/this.L,this.L/this.G));if(this.b=e)if(b=bb(e,"requestFullscreen")||bb(e,"requestFullScreen")){this.b.ib=e[b];if(e=bb(document,"on","fullscreenchange")){var h=bb(document,"fullscreenElement")||bb(document,"fullScreenElement");document.addEventListener(e,function(){Ef(f,null!=document[h])},!1)}(e=bb(document,"on","fullscreenerror"))&&document.addEventListener(e,function(){Ef(f)},!1)}if(this.R=a.fontROM)"json"!=Ba(this.R)&&(this.R=Ua()+"/api/v1/dump?file="+
this.R+"&format=bytes"),Sa(this.R,null,!0,function(k,l,p){Ff(f,k,l,p)});this.xa={}}oa(Bf,x);
function Qe(a){a.C=a.N*a.ea;a.M=a.Y*a.ba;var b=a.C,c=a.M;a.g&&(b=a.M,c=a.C);a.I=0;if(!a.xd&&(a.I=(a.C*a.la>>3)*a.M,!gc(a.H,a.ja,a.I,3)))return!1;a.I?(a.ab=a.j.createImageData(b,c),a.cb=16/a.la|0,Gf(a,a.I>>1)):Gf(a,(a.N+1)*a.Y);a.D=document.createElement("canvas");a.D.width=b;a.D.height=c;a.ra=a.D.getContext("2d");a.S={};a.W=1<<a.la;a.T=Array(a.W+Hf);a.T[0]=[0,0,0,255];a.T[1]=[255,255,255,255];a.X==If&&(a.T[a.W+Jf]=[255,255,0,255],a.T[a.W+Kf]=[0,255,0,255]);a.X==Lf&&(a.fb=60,a.wa=!1,a.da=Array(a.N));
a.ob&&(a.j[a.ob]=null==a.Ta?!1:a.Ta);return!0}m=Bf.prototype;m.ca=function(a,b,c){var d=this;if("led"==a||"rled"==a)return this.xa[b]=c,!0;switch(b){case "fullScreen":return this.O[b]=c,this.b&&this.b.ib?c.onclick=function(){d.ib()}:c.parentNode.removeChild(c),!0}return!1};
m.Da=function(a,b,c,d){this.P=a;this.H=b;this.w=c;this.J=d;Qe(this);if(this.B=cc(a,"Keyboard")){for(var e in this.xa)this.B.ca("led",e,this.xa[e]);this.F&&this.B.ca(this.Dd?"textarea":"canvas","screen",this.U)}var f=this;this.yc=xd(this.w,this.id,function(){Cd(f)});yd(this.w,this.yc,1E3/Math.max(this.ub,this.ma));this.eb=0;this.R||Rb(this)};
function Ff(a,b,c,d){if(d)a.Z("Unable to load font ROM (error "+d+": "+b+")");else{xb(a.Pa,b,c);try{var e=eval("("+c+")"),f=e.bytes||e;if(!f||!f.length){v("Empty font ROM: "+b);return}if(1==f.length){v(f[0]);return}if(2048==f.length)a.aa=f,Re(a);else{a.Z("Unrecognized font data length ("+f.length+")");return}}catch(g){a.Z("Font ROM data error: "+g.message);return}(a.j||a.J)&&Rb(a)}}
function Re(a){a.aa&&(a.Ka=a.X==Lf,a.S[Mf]=[Nf(a,a.ea,a.ba),Nf(a,a.ea,a.ba,a.wa)],a.S[Of]=[Nf(a,2*a.ea,a.ba),Nf(a,2*a.ea,a.ba,a.wa)],a.S[Pf]=a.S[Qf]=[Nf(a,2*a.ea,2*a.ba),Nf(a,2*a.ea,2*a.ba,a.wa)])}
function Nf(a,b,c,d){var e=8>=a.Ba?8:16,f=8<e?15:0,g=a.aa.length/e,h=!1===d,k={ea:b,ba:c};k.canvas=document.createElement("canvas");k.canvas.width=16*b;k.canvas.height=g/16*c;k.context=k.canvas.getContext("2d");for(var l=k.context.createImageData(b,c),p=0;p<g;p++){for(var u=0,y=u;u<a.ba;u++){var q=p*e+(f+u&e-1);q=d&&8==u?255:a.aa[q];for(var w=0;w<c/a.ba;w++){for(var z=0,D=0,G=D;D<a.ea;D++){var F=q&128>>(7<D?7:D);z=a.Ka&&!F&&z?z:F;for(var ca=0;ca<b/a.ea;ca++)h&&(z=!z),Rf(a,l,G,y,z?1:0),G++;z=F}y++}}k.context.putImageData(l,
(p&15)*b,(p>>4)*c)}return k}m.ta=function(a,b){return b||!a||this.restore(a)?!0:!1};m.sa=function(a){return!a||this.save()};m.save=function(){var a=new Kd(this);a.set(0,[]);return a.data()};m.restore=function(){return!0};
m.ib=function(){var a=!1;if(this.b){if(this.b.ib){a="100%";if(screen&&screen.width&&screen.height){var b=screen.width/screen.height,c=this.L/this.G;b>c&&(a=Math.round(c/b*100)+"%")}this.Ra?(this.F.style.width=a,this.F.style.width=a,this.F.style.display="block",this.F.style.margin="auto"):(this.b.style.width=a,this.b.style.height="auto");this.b.style.backgroundColor="black";this.b.ib();a=!0}this.U&&this.U.focus()}return a};
function Ef(a,b){!b&&a.b&&(a.Ra?a.F.style.width=a.F.style.height="":a.b.style.width=a.b.style.height="");Vb(a,"notifyFullScreen("+b+")")}function Gf(a,b){a.bb=b;a.V=!1;if(void 0===a.A||a.A.length!=a.bb)a.A=Array(a.bb)}function Rf(a,b,c,d,e){d=a.g?(b.height-c-1)*b.width+d:c+d*b.width;e&&a.X==If&&(208<=c&&236>c?e=a.W+Jf:28<=c&&72>c&&(e=a.W+Kf));a=a.T[e];d*=a.length;b.data[d]=a[0];b.data[d+1]=a[1];b.data[d+2]=a[2];b.data[d+3]=a[3]}
function Cd(a,b){var c=!0;if(!b){a.ma&&(120==a.ma?a.eb&1?(he(a.w,2),c=!1):he(a.w,1):he(a.w,4));if(c&&a.V&&a.I){var d=a.H,e=a.ja,f=a.I,g=!0,h=e>>>d.g;for(e=d.u-(e&d.j);0<f&&h<d.b.length;)d.b[h].Ca&&(d.b[h].Ca=g=!1,d.b[h].Cc=!0),f-=e,e=d.u,h++;g&&(c=!1)}yd(a.w,a.yc,1E3/Math.max(a.ub,a.ma));a.eb++}if(c)if(1<a.ea)switch(a.X){case Lf:c=a.ja;d=-1;f=0;g=60==a.fb?2:5;e=h=0;for(var k=-1;f<a.Y;){var l=0,p=c,u=d,y=a.N;for(u!=Mf&&(y>>=1);;){var q=lc(a.H,p++);if((q&Sf)==Sf){var w=lc(a.H,p++);d=w&Tf;c=(w&Uf)<<
8|lc(a.H,p);c+=w&Vf?Wf:Xf;break}if(l<y)a.da[l++]=q;else break}if(g)g--;else{for(;l<a.da.length;)a.da[l++]=0;if(0<=u)for(p=a.V&&a.A[h]==y,a.A[h++]=y,y=0;y<l;y++){q=a.da[y];if(!p||q!==a.A[h]){a.A[k=h]=q;w=a;var z=a.ra;var D=q&127;if(q=w.S[u][q&128?1:0]){var G=(D&15)*q.ea,F=(D>>4)*q.ba,ca=q.ea,la=q.ba;if(z){var ma=y*w.ea;var ta=f*w.ba;var ya=w.ea;D=w.ba}else ma=y*w.Ia,ta=f*w.Ja,ya=w.Ia,D=w.Ja;q.ea>w.ea&&(ma*=2,ya*=2);q.ba>w.ba&&(u==Qf&&(F+=w.ba),la=w.ba);z?z.drawImage(q.canvas,G,F,ca,la,ma,ta,ya,D):
w.j.drawImage(q.canvas,G,F,ca,la,ma,ta,ya,D)}e++}h++}f++}}a.V=!0;!b&&a.ua&&1==e&&(a.A[k]=-1,e=0);a.ua=!1;(e||b)&&a.ra&&a.j.drawImage(a.D,0,a.qa,a.C,a.M-a.ba,0,0,a.td,a.vd)}else{f=a.ja;g=f+a.I;k=e=h=0;b=a.C;l=0;c=a.M;u=d=0;p=a.la;y=(1<<p)-1;a.zd&&(p=-p,u=16+p);for(;f<g;){w=nc(a.H,f);if(a.V&&w===a.A[h])e+=a.cb;else{a.A[h]=w;(z=u)&&(w=w>>8|(w&255)<<8);e<b&&(b=e);for(q=a.cb;q--;)G=w>>z&y,Rf(a,a.ab,e++,k,G),z+=p;e>l&&(l=e);k<c&&(c=k);k>=d&&(d=k+1)}f+=2;h++;if(e>=a.C&&(e=0,k++,k>a.M))break}a.V=!0;b<a.C&&
(f=l-b,d-=c,a.g&&(g=b,h=f,b=c,f=d,c=a.C-(g+h),d=h),a.ra.putImageData(a.ab,0,0,b,c,f,d),a.j.drawImage(a.D,0,0,a.D.width,a.D.height,0,0,a.L,a.G))}}var Jf=0,Kf=1,Hf=2,Df=0,If=1,Lf=2,Cf={SI1978:If,VT100:Lf},Mf=96,Of=64,Pf=32,Qf=0,Sf=127,Uf=15,Vf=16,Tf=96,Wf=8192,Xf=16384;
lb(function(){for(var a=Eb(document,"pcx80","video"),b=0;b<a.length;b++){var c=a[b],d=Fb(c),e=Eb(c,"pcjs-canvas");if(!e||!e.length||!e[0].getContext){c.innerHTML="<br/>Missing &lt;canvas&gt; support. Please try a newer web browser.";break}e=e[0];e.style.backgroundColor=d.screenColor;0<=Wa().indexOf("MSIE")&&(c.onresize=function(h,k,l,p){return function(){k.style.height=(h.clientWidth*p/l|0)+"px"}}(c,e,d.screenWidth,d.screenHeight),c.onresize());var f=+(d.aspect||gb("aspect"));f&&.3<=f&&3.33>=f&&(kb("onresize",
function(h,k,l){return function(){k.style.height=(h.clientWidth/l|0)+"px"}}(c,e,f)),window.onresize());f=document.createElement("textarea");ab("iOS")&&(f.setAttribute("autocapitalize","off"),f.setAttribute("autocorrect","off"),f.style.fontSize="16px");c.appendChild(f);var g=e.getContext("2d");d=new Bf(d,e,g,f,c);Db(d,c)}});
function Yf(a){x.call(this,"SerialPort",a,4096);this.S=+a.adapter;switch(this.S){case 0:this.T=0;this.W=2;break;default:v("Unrecognized serial adapter #"+this.S);return}this.g=this.j=null;this.U=a.tabSize;this.R=a.charBOL;this.u=0;this.M=!1;this.D=!0;a=a.binding;if("console"==a)this.j="";else if(a){var b=Ib("Panel",this.id);b&&(b=b.O[a])&&this.ca("",a,b)}this.A="";this.b=this.Oa=this.G=null;this.exports={connect:this.Ec,receiveData:this.Mb,receiveStatus:this.me}}oa(Yf,x);m=Yf.prototype;
m.ca=function(a,b,c,d){var e=this;return a&&"textarea"!=a?d?(this.O[b]=c,c.onclick=function(){e.Mb(d);return!0},!0):!1:(this.O[b]=this.g=c,c.onkeydown=function(f){f=f||window.event;var g=f.keyCode;if(8===g||f.ctrlKey&&65<=g&&90>=g)f.preventDefault&&f.preventDefault(),64<g&&(g-=64),Zf(e,g);return!0},c.onkeypress=function(f){f=f||window.event;Zf(e,f.which||f.keyCode);f.preventDefault&&f.preventDefault();return!0},c.removeAttribute("readonly"),!0)};
m.Da=function(a,b,c,d){this.P=a;this.H=b;this.w=c;this.J=d;var e=this;this.X=xd(this.w,this.id+".receive",function(){e.Mb()});this.Y=xd(this.w,this.id+".transmit",function(){kf(e)});this.V=cc(a,"ChipSet");Bc(b,this,$f,this.T);Fc(b,this,ag,this.T);Rb(this)};
m.Ec=function(a){if(!this.b){var b=ad(this.P,"connection");if(b){var c=b.split("->");if(2==c.length){var d=Na(c[0]);if(d!=this.Fb)return;c=Na(c[1]);if(this.b=Hb(c)){var e=this.b.exports;if(e){var f=e.connect;f&&f.call(this.b,this.D);if(this.Oa=e.receiveData){this.D=a;this.G=e.receiveStatus;this.status("Connected %s.%s to %s",this.Pa,d,c);return}}}}this.status("Unable to establish connection: %s",b)}}};
m.ta=function(a,b){if(!b)if(this.Ec(this.D),!a||!this.restore)this.reset();else if(!this.restore(a))return!1;return!0};m.sa=function(a){return a?this.save():!0};m.reset=function(){bg(this)};m.save=function(){var a=new Kd(this),b=0,c=[];c[b++]=this.F;c[b++]=this.L;c[b++]=this.N;c[b++]=this.ga;c[b++]=this.B;c[b++]=this.C;c[b]=this.I;a.set(0,c);return a.data()};m.restore=function(a){return bg(this,a[0])};
function bg(a,b){var c=0;void 0===b&&(b=cg);a.F=b[c++];a.L=b[c++];a.N=b[c++];a.ga=b[c++];a.B=b[c++];a.C=b[c++];a.I=b[c];return!0}function dg(a,b){var c=a.I&b;b&15||(c>>=4);b=eg[c];c=((a.B&fg)>>2)+6;a.B&gg&&c++;c+=((a.B&hg)>>6)+1>>1;return 1E3/(b/c)|0}function Zf(a,b){Vb(a,"receiveByte("+za(b)+"), status="+za(a.ga));return a.M||a.ga&ig?!1:(a.L=b,a.ga|=ig,he(a.w,a.W),!0)}
m.Mb=function(a){null!=a&&(this.A="number"!=typeof a?a:this.A+String.fromCharCode(a));this.A&&(Zf(this,this.A.charCodeAt(0))&&(this.A=this.A.substr(1)),this.A&&this.w&&yd(this.w,this.X,dg(this,jg)));return!0};m.me=function(a){this.ga&=~kg;a&64&&(this.ga|=kg)};function kf(a,b){a.ga=a.ga|Pe|lg;b&&a.Oa&&a.Oa.call(a.b,b)}m.Gd=function(a,b){var c=this.L;A(this,a,void 0,b,"DATA",c);this.ga&=~ig;return c};m.Fd=function(a,b){var c=this.ga;A(this,a,void 0,b,"STATUS",c);return c};
m.Ud=function(a,b,c){A(this,a,b,c,"DATA");this.N=b;this.ga&=~(Pe|lg);Vb(this,"transmitByte("+za(b)+")");if(19==b)this.M=!0;else if(17==b)this.M=!1;else if(this.Oa&&this.Oa.call(this.b,b),this.g)if(8==b)this.g.value=this.g.value.slice(0,-1),0<this.u&&this.u--;else{var d;13!=b&&10!=b&&(d=Oa[b]);a=d=d?"<"+d+">":String.fromCharCode(b);c=a.length;9==b?(b=this.U||8,c=b-this.u%b,this.U&&(a=Ga("",c))):13==b&&(this.u=c=0,a="\n");this.R&&!this.u&&c&&(a=String.fromCharCode(this.R)+a);this.g.value+=a;this.g.scrollTop=
this.g.scrollHeight;this.u+=c}else if(null!=this.j){if(10==b||1024<=this.j.length)this.i(this.j),this.j="";10!=b&&(this.j+=String.fromCharCode(b))}this.w&&yd(this.w,this.Y,dg(this,mg))};m.Td=function(a,b,c){A(this,a,b,c,"CONTROL");this.F?(this.G&&(b^this.C)&(ng|og)&&(a=0,this.D?(a|=b&ng?32:0,a|=b&og?320:0):(a|=b&ng?16:0,a|=b&og?1048576:0),this.G.call(this.b,a)),this.C=b,this.C&pg&&(this.F=!1)):(this.B=b,this.F=!0)};m.Sd=function(a,b,c){A(this,a,b,c,"BAUDRATES");this.I=b};
var fg=12,gg=16,hg=192,og=2,ng=32,pg=64,Pe=1,ig=2,lg=4,kg=128,jg=15,mg=240,eg=[50,75,110,134.5,150,200,300,600,1200,1800,2E3,2400,3600,4800,9600,19200],cg=[!1,0,0,133,142,39,238],$f={0:Yf.prototype.Gd,1:Yf.prototype.Fd},ag={0:Yf.prototype.Ud,1:Yf.prototype.Td,2:Yf.prototype.Sd};lb(function(){for(var a=Eb(document,"pcx80","serial"),b=0;b<a.length;b++){var c=a[b],d=Fb(c);d=new Yf(d);Db(d,c)}});
function qg(a,b,c){x.call(this,a,b,c);this.u=+b.base||16;this.V=["{","}"];this.da=["[","]"];this.S=this.aa=this.F=0;this.N=!1;this.b=-1;this.g=[];this.A={}}oa(qg,x);qg.prototype.Ib=function(){return-1};qg.prototype.Jb=function(){};
qg.prototype.yb=function(a,b,c){if(b)if(a){0>this.b&&this.g.length&&(this.b=0);if(0>this.b||a!=this.g[this.b])this.g.splice(0,0,a),this.b=0;this.b--}else this.N?a="end":a=this.g[this.b+1];b=[];if(a){a=a.replace(/""/g,"'");var d=0,e=null;c=c||";";for(var f=0;f<=a.length;f++){var g=a.charAt(f);if('"'==g||"'"==g)e?g==e&&(e=null):e=g;else if(g==c&&!e||!g)b.push(Na(a.substring(d,f))),d=f+1}}return b};
function rg(a,b,c){var d=a;b=b||32;if(c)if(32==b)d=a>>>0;else if(32>b)d=a&(1<<b)-1;else{if(b=Math.pow(2,b),0>a||a>=b)d=a%b,0>d&&(d+=b)}else 32>=b?d=a<<32-b>>32-b:(b=Math.pow(2,b-1),a>=b?(d=a%b,(a/b|0)&1&&(d-=b)):a<-b&&(d=a%b,((-a-1)/b|0)&1?d&&(d+=b):d||(d-=b)));a!=d&&(a=d);return a}
function sg(a,b,c){for(c=void 0===c?-1:c;c--&&b.length;){var d=b.pop();if(2>a.length)return!1;var e=a.pop();var f=a.pop();switch(d){case "*":f*=e;break;case "/":if(!e)return!1;f=Math.trunc(f/e);break;case "^/":if(!e)return!1;f%=e;break;case "+":f+=e;break;case "-":f-=e;break;case "<<":f<<=e;break;case ">>":f>>=e;break;case ">>>":f>>>=e;break;case "<":f=f<e?1:0;break;case "<=":f=f<=e?1:0;break;case ">":f=f>e?1:0;break;case ">=":f=f>=e?1:0;break;case "==":f=f==e?1:0;break;case "!=":f=f!=e?1:0;break;
case "&":f&=e;break;case "!":case "|":f|=e;break;case "^!":f^=e;break;case "&&":f=f&&e?1:0;break;case "||":f=f||e?1:0;break;case ",,":f=rg(f,18,!0)*Math.pow(2,18)+rg(e,18,!0);break;case "_":case "^_":"^_"==d&&(e=35-(e&255));e&&(f=rg(f,0,!0),f=0<e?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));break;default:return!1}a.push(rg(f))}return!0}
function tg(a,b,c,d,e,f){var g,h=!1,k=0,l=[],p=[],u=a.u;for(a.u=e;c<d;){var y=b[c++].trim();var q=c<d?b[c++]:"";if(y)var w=ug(a,y,void 0,f,k);else if("{"==q){y=1;for(w=c;c<d;)if(c++,q=c<b.length?b[c++]:"","{"==q)y++;else if("}"==q&&!--y)break;w=tg(a,b,w,c-1,a.u,f);null!=w&&k&&(w=vg(w,k));y=c<d?b[c++].trim():"";q=c<d?b[c++]:""}else{if(" "==q)continue;if("^B"==q){a.u=2;continue}if("^O"==q){a.u=8;continue}if("^D"==q){a.u=10;continue}if(!(k&-1073741824)){if("+"==q)continue;if("-"==q){k=k<<2|1;continue}if("~"==
q||"^-"==q){k=k<<2|2;continue}if("^L"==q){k=k<<2|3;continue}}h=!0;break}if(void 0===w)if(f)f.push(y),w=0;else{h=!0;f=[];break}l.push(rg(w));if(" "==q)if(c<b.length-1&&!b[c])c++,q=b[c++];else{h=!0;break}if(!q)break;k="<"==a.V[0]?wg:xg;if(!k[q]){h=!0;break}p.length&&k[q]<=k[p[p.length-1]]&&sg(l,p,1);p.push(q);a.u="^_"==q?10:e;k=0}if(h||!sg(l,p)||1!=l.length)h=!0;h?f||a.i("parse error ("+(y||q)+")"):g=l.pop();a.u=u;return g}
function Yg(a,b,c,d,e){for(var f;0<=(f=b.indexOf(c));){for(var g=0,h=f+1,k=e;h<b.length;){var l=b[h++];if(l==c){k=-1;break}if(!k)break;k--;l=l.charCodeAt(0);7==d?l&=127:l=l-32&63;g=rg(g*Math.pow(2,d)+l,d*e,!0)}if(0<=k){a.i("parse error ("+c+b+c+")");return}b=b.substr(0,f)+$g(a,g,-1)+b.substr(h)}return b}
function ah(a,b,c){var d=void 0,e=!1===c;c=Array.isArray(c)?c:void 0;if(b){"{"!=a.V[0]&&(b=b.split(a.V[0]).join("{").split(a.V[1]).join("}"));b=Yg(a,b,'"',7,5);if(!b)return d;b=Yg(a,b,"'",6,6);if(!b)return d;16!=a.u&&(b=b.replace(/(^|[^A-Z0-9$%.])([0-9]+)B/,"$1$2^_").replace(/\s+/g," "));b=b.split(/({|}|\|\||&&|\||\^!|\^B|\^O|\^D|\^L|\^-|~|\^_|_|&|!=|!|==|>=|>>>|>>|>|<=|<<|<|-|\+|\^\/|\/|\*|,,| )/);d=tg(a,b,0,b.length,a.u,c);void 0!==d&&e&&bh(a,null,d)}return d}
function ch(a,b){var c=a.V[0],d=a.V[1];var e="("==c||"{"==c||"["==c?"\\":"";var f="["==c?"\\":"";for(f=new RegExp(e+c+"([^"+f+c+f+d+"]+)"+e+d);e=b.match(f);){var g=ah(a,e[1]);if(void 0===g)return;b=b.replace(c+e[1]+d,null!=g?$g(a,g):"undefined")}if(a.da.length)for(c=a.da[0],d=a.da[1],e="("==c||"{"==c||"["==c?"\\":"",f="["==c?"\\":"",f=new RegExp(e+c+"([^"+f+c+f+d+"]+)"+e+d);e=b.match(f);)b=b.replace("["+e[1]+"]","unimplemented");for(;c=b.match(/\$([a-z]+)/i);){d=null;switch(c[1].toLowerCase()){case "ops":d=
a.S-a.aa}if(null==d)break;b=b.replace(c[0],d.toString())}return b}function vg(a,b){for(;b;){var c;switch(b&3){case 1:a=-rg(a);break;case 2:a^=-1;break;case 3:for(c=35;0<=c&&!(a&Math.pow(2,c));)c--;a=35-c}b>>>=2}return a}
function ug(a,b,c,d,e){e=void 0===e?0:e;var f=Array.isArray(d)?d:void 0;if(void 0!=b){var g=a.Ib(b);if(0<=g)g=a.Jb(g);else if(g=b,a.A[g]?g=a.A[g].value:(g=g.substr(0,6),g=a.A[g]&&a.A[g].value),void 0!=g){var h=a.A[b]&&a.A[b].oe;h&&(f?f.push(h):(f=ah(a,h,d),void 0!==f?g+=f:(d||a.i("undefined "+(c||"value")+": "+b+" ("+h+")"),g=void 0)))}else g=wa(b,1<b.length||10<a.u?a.u:10);void 0!=g?g=rg(vg(g,e)):d||a.i("invalid "+(c||"value")+": "+b)}else d||a.i("missing "+(c||"value"));return g}
function bh(a,b,c){var d=!1;if(void 0!==c){d=!0;var e=8==a.u?$g(a,c,32,8,1)+"  "+c+".":$g(a,c,32,16,1)+"  "+$g(a,c,32,8,1)+"  "+$g(a,c,32,2,8)+"  "+c+".";32<=c&&127>c&&(e+=" '"+String.fromCharCode(c)+"'")}a.i((null!=b?b+": ":"")+e);return d}function dh(a,b){var c=0;if(a.A){if(b)return bh(a,b,a.A[b]&&a.A[b].value);b=Object.keys(a.A);b.sort();for(var d=0;d<b.length;d++)bh(a,b[d],a.A[b[d]].value),c++}return 0<c}
function $g(a,b,c,d,e){c=void 0===c?0:c;e=void 0===e?0:e;switch((void 0===d?0:d)||a.u){case 2:(a=0<c?c:0)?36<a&&(a=36):(a=Math.abs(b),a=255>=a?8:262143>=a?18:36);b=xa(b,2,a,"",e);break;case 8:(a=0<c?(c+2)/3|0:0)?12<a&&(a=12):(a=Math.abs(b),a=262143>=a?6:16777215>=a?8:12);b=xa(b,8,a,e?"0o":"");break;case 10:(e=0<c?Math.ceil(.3*c):0)?11<e&&(e=11):e=99999>=Math.abs(b)?5:11;b=xa(b,10,e);break;default:b=r(b,0<c?c+3>>2:0,!!e)}return c=0>c?b.replace(/^0+([0-9A-F]+)$/i,"$1"):b}
var xg={"||":5,"&&":6,"!":7,"|":7,"^!":8,"&":9,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,_:19,"^_":19,"{":20,"}":20},wg={",,":1,"||":5,"&&":6,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"!":15,"|":15,"^!":15,"&":15,_:19,"^_":19,"{":20,"}":20};
function eh(a){qg.call(this,"Debugger",a,-1);this.style=fh;this.L=gh();this.qa=gh();this.T=gh();this.C=[];this.j=this.M=this.B=[];hh(this);this.W=0;ih(this);this.ja={};jh(this,a.messages);this.la=a.commands;var b=this;window?void 0===window.pcx80&&(window.pcx80=function(c){return od(b,c)}):void 0===global.pcx80&&(global.pcx80=function(c){return od(b,c)})}oa(eh,qg);m=eh.prototype;
m.Da=function(a,b,c,d){this.H=b;this.w=c;this.P=a;(a=ad(a,"messages"))&&jh(this,a);this.ma=kh;Me(this,4,function(e){a:{var f=d.H.b,g=e[0],h=e=0,k=f.length;if(g){e=lh(mh(d,g));if(-1===e){d.i("invalid address: "+g);break a}h=e>>>d.H.g;k=1}d.i("blockid   physical   blockaddr   used    size    type");d.i("--------  ---------  ----------  ------  ------  ----");g=-1;for(var l=0;k--;){var p=f[h];p.type==g?l++||d.i("..."):(g=p.type,l=jc[g],p&&d.i(r(p.id)+"  %"+r(h<<d.H.g)+"  %%"+r(p.K)+"  "+t(p.lb)+"  "+
t(p.size)+"  "+l),g!=Mc&&(g=-1),l=0);e+=d.H.u;h++}}});Rb(this)};
m.ca=function(a,b,c){var d=this;switch(b){case "debugInput":return this.I=this.O[b]=c,c.onkeydown=function(e){if(13==e.keyCode){var f=d.I.value;d.I.value="";od(d,f,!0)}else if(27==e.keyCode)d.I.value=f="";else if(38==e.keyCode?(f=null,d.b<d.g.length-1&&(f=d.g[++d.b])):40==e.keyCode&&(0<d.b?f=d.g[--d.b]:(f="",d.b=-1)),null!=f){var g=f.length;d.I.value=f;d.I.setSelectionRange(g,g)}null!=f&&e.preventDefault&&e.preventDefault()},!0;case "debugEnter":return this.O[b]=c,jb(c,function(){if(d.I){var e=d.I.value;
d.I.value="";od(d,e,!0);return!0}return!1}),!0;case "step":return this.O[b]=c,jb(c,function(e){var f=!1;Sb(d,!0)||(Tb(d,!0),f=nh(d,e?1:0),Tb(d,!1));return f}),!0}return!1};m.Wa=function(){this.I&&this.I.focus()};function lh(a){a=a&&a.K;null==a&&(a=-1);return a}m.Ea=function(a,b){var c=255,d=lh(a);-1!==d&&(c=lc(this.H,d),b&&oh(a,b));return c};m.Db=function(a,b){var c=65535,d=lh(a);-1!==d&&(c=nc(this.H,d),b&&oh(a,b));return c};
m.Wb=function(a,b,c){var d=lh(a);-1!==d&&(oc(this.H,d,b),c&&oh(a,c),pd(this.w,!0))};m.Pc=function(a,b,c){var d=lh(a);if(-1!==d){var e=this.H,f=d&e.j,g=(d&e.C)>>>e.g;f!=e.j?e.b[g].Rb(f,b&65535,d):(e.b[g++].mb(f,b&255,d),e.b[g&e.G].mb(0,b>>8&255,d+1));c&&oh(a,c);pd(this.w,!0)}};function gh(a){return{K:a,Aa:!1}}function ph(a){return{K:a[0],Aa:a[1]}}
function mh(a,b,c){c=(c?a.L:a.qa).K;if(void 0!==b){b=ch(a,b)||b;var d;if(b.match(/^[a-z_][a-z0-9_]*$/i)){var e=b.toUpperCase();for(c=0;c<a.C.length;c++){var f=a.C[c].pa[e];if(void 0!==f){e=f.o;void 0!==e&&(d=gh(e));break}}}if(e=d)return e;c=ah(a,b)}null!=c&&(e=gh(c));return e}function qh(a,b,c){c&&(c=c.match(/(['"])(.*?)\1/))&&(b.rd=a.yb(b.Ic=c[2]))}function oh(a,b){null!=a.K&&(a.K+=b||1)}function rh(a){return r(a.K,4)}
function sh(a,b,c){var d="";for(c=c||256;d.length<c;){var e=a.Ea(b,1);if(!e||36==e||127<=e)break;d+=32<=e?String.fromCharCode(e):"."}return d}function jh(a,b){a.J=a;a.fa=268435456;a.X=null;a.Y=[];b=a.yb(b.replace("keys","key").replace("kbd","keyboard"),!1,"|");if(b.length)for(var c in ac)0<=Ra(b,c)&&(a.fa|=ac[c],a.i(c+" messages enabled"))}function Me(a,b,c){for(var d in ac)if(b==ac[d]){a.ja[d]=c;break}}
m.Ib=function(a,b){a=a.toUpperCase();if(null==b)var c=Ra(th,a);else c=Ra(th,a.substr(b,2)),0>c&&(c=Ra(th,a.substr(b,1)));return c};function uh(a,b){var c=0;a=a.Jb(b);if(void 0!==a)switch(b){case vh:case wh:case xh:case yh:case zh:case Ah:case Bh:case Ch:c=2;break;case Dh:case Eh:case Fh:case Gh:case Hh:case Ih:case Jh:c=4}return c?r(a,c):"??"}
m.Jb=function(a){if(0<=a){var b=this.w;switch(a){case vh:var c=b.g;break;case wh:c=b.u;break;case xh:c=b.A;break;case Dh:c=Ld(b);break;case yh:c=b.B;break;case zh:c=b.C;break;case Eh:c=Nd(b);break;case Ah:c=b.D;break;case Bh:c=b.F;break;case Fh:c=E(b);break;case Ch:c=H(b,E(b));break;case Gh:c=b.L;break;case Hh:c=b.j;break;case Ih:c=Jd(b);break;case Jh:c=Jd(b)&255|b.g<<8}}return c};
function Kh(a,b){b=ch(a,b)||b;for(var c=0,d,e;0<=(c=b.indexOf("@",c));)e=a.Ib(b,c+1),0<=e&&(b=b.substr(0,c)+uh(a,e)+b.substr(c+1+th[e].length)),c++;for(c=0;0<=(c=b.indexOf("#",c));)e=b.substr(c+1,2),d=wa(e,16),null!=d&&32<=d&&127>d?(d=e+" '"+String.fromCharCode(d)+"'",b=b.replace("#"+e,d),c+=d.length):c++;for(c=0;0<=(c=b.indexOf("$",c));)e=b.substr(c+1,9),(d=mh(a,e))?(d=e+' "'+sh(a,d)+'"',b=b.replace("$"+e,d),c+=d.length):c++;for(c=0;0<=(c=b.indexOf("^",c));)e=b.substr(c+1,9),(d=mh(a,e))?(oh(d),d=
e+' "'+sh(a,d,11)+'"',b=b.replace("^"+e,d),c+=d.length):c++;return b}m.message=function(a,b){b&&(a+=" at "+rh(gh(this.w.j)));this.fa&1073741824?this.Y.push(a):this.X&&a==this.X||(this.X=a,this.fa&536870912&&(Yc(this),a+=" (cpu halted)"),this.i(a),this.w&&(a=this.w,zd(a),a.ra=0,pd(a)))};function Yb(a,b,c,d,e,f,g,h){h|=16;null!=f&&(a.fa&h)!=h||a.message(b.Fb+"."+(null!=d?"outPort":"inPort")+"("+t(c)+","+(f?f:"unknown")+(null!=d?","+za(d):"")+")"+(null!=g?": "+za(g):"")+(null!=e?" at "+r(e,4):""))}
function ih(a){var b;if(ie(a)){if(!a.G||!a.G.length){a.G=Array(Lh);for(b=0;b<a.G.length;b++)a.G[b]=gh();a.U=0;a.i("instruction history buffer allocated")}if(!a.D||!a.D.length)for(a.D=Array(256),b=0;b<a.D.length;b++)a.D[b]=[b,0]}else a.G&&a.G.length&&a.i("instruction history buffer freed"),a.U=0,a.G=[],a.D=[]}function Mh(a,b){if(!Nh(a))return!1;a.w.qb(b);return!0}
function nh(a,b,c,d){if(!Nh(a))return!1;a.F=0;b||ie(a)&&je(a,a.w.j,0);try{var e=a.w.Bb(b);0<e&&(a.F+=e,ud(a.w,e,!0),qd(a.w,e),a.S++)}catch(f){"number"!=typeof f&&(b=f,a.F=0,Pb(a.w,b.stack||b.message))}!1!==d&&pd(a.w);nd(a,c||!1);return 0<a.F}function Yc(a,b){a.w&&sd(a.w,b)}function nd(a,b){void 0===b&&(b=!0);a.L=gh(a.w.j);b&&1!=a.R?Oh(a):Ph(a)}
function Nh(a){var b;if(b=a.w&&Qb(a.w))b=a.w,b.flags.ha?b=!0:(b.i(b.toString()+" not powered"),b=!1);b&&!Sb(a.w)?(a=a.w,a.flags.error?(a.i(a.toString()+" error"),a=!0):a=!1,a=!a):a=!1;return a}m.ta=function(a,b){return!b&&(this.reset(!0),a&&this.restore&&!this.restore(a))?!1:!0};m.sa=function(a,b){b&&this.i(a?"suspending":"shutting down");return a?this.save():!0};m.reset=function(a){ih(this);this.S=this.aa=0;this.X=null;this.F=0;this.L=gh(this.w.j);this.flags.ia=!1;Qh(this);a||nd(this)};
m.save=function(){var a=new Kd(this),b=this.L;a.set(0,[b.K,b.Aa]);b=this.T;a.set(1,[b.K,b.Aa]);a.set(2,[this.g,this.N,this.fa]);a.set(3,this.C);return a.data()};m.restore=function(a){var b=0;void 0!==a[2]&&(this.L=ph(a[b++]),this.T=ph(a[b++]),this.g=a[b][0],"string"==typeof this.g&&(this.g=[this.g]),this.N=a[b][1],this.fa|=a[b][2]);a[3]&&(this.C=a[3]);return!0};m.start=function(a,b){this.R||this.i("running");this.flags.ia=!0;this.wa=a;this.xa=b};
m.stop=function(a,b){if(this.flags.ia){this.flags.ia=!1;this.F=b-this.xa;if(!this.R){b="stopped";if(this.F){a-=this.wa;var c=0<a?Math.round(1E3*this.F/a):0;b+=" (";ie(this)&&(b+=this.S+" opcodes, ",this.aa-=this.S,this.S=0);b+=this.F+" cycles, "+a+" ms, "+c+" hz)"}else Ub(this,536870912)&&(b+=" (use the 't' command to execute blocked faults)");this.i(b)}nd(this,!0);this.Wa();Qh(this,this.w.j)}};function ie(a){return 1<a.j.length||!!a.W}
function je(a,b,c){var d=a.w;if(0<c&&(a.W&&!--a.W||Xc(a,b,1,a.j)))return!0;0<=c&&a.D.length&&(a.S++,b=lc(a.H,b),null!=b&&(a.D[b][1]++,b=a.G[a.U],b.K=d.j,b.Aa=!1,++a.U==a.G.length&&(a.U=0)));return!1}function Dc(a,b,c){a.i("break on input from port "+t(b)+": "+r(c));Yc(a,!0)}function Hc(a,b,c){a.i("break on output to port "+t(b)+": "+r(c));Yc(a,!0)}
function hh(a){var b;a.j=["bp"];if(void 0!==a.M)for(b=1;b<a.M.length;b++){var c=a.M[b];var d=a.H;Wc(d.b[lh(c)>>>d.g],!1)}a.M=["br"];if(void 0!==a.B)for(b=1;b<a.B.length;b++)c=a.B[b],d=a.H,Wc(d.b[lh(c)>>>d.g],!0);a.B=["bw"];a.ra=0}m.Ma=function(a,b,c){var d=!0;c||Rh(this,a,b,!1,!0);if(a!=this.j){var e=lh(b);if(-1===e)this.i("invalid address: "+rh(b)),d=!1;else{var f=this.H;f.b[e>>>f.g].Ma(e&f.j,a==this.B)}}d&&(a.push(b),c?b.Aa=!0:(Sh(this,a,a.length-1,"set"),ih(this)))};
function Rh(a,b,c,d,e){var f=!1;c=lh(c);for(var g=1;g<b.length;g++){var h=b[g];if(c==lh(h)&&(!d||h.Aa)){f=!0;h.Aa||e||Sh(a,b,g,"cleared");b.splice(g,1);b!=a.j&&(d=a.H,Wc(d.b[c>>>d.g],b==a.B));h.Aa||ih(a);break}}return f}function Th(a,b){for(var c=1;c<b.length;c++)Sh(a,b,c);return b.length-1}function Sh(a,b,c,d){c=b[c];a.i(b[0]+" "+rh(c)+(d?" "+d:c.Ic?' "'+c.Ic+'"':""))}
function Qh(a,b){if(void 0!==b)Xc(a,b,1,a.j,!0),a.R=0;else for(b=1;b<a.j.length;b++){var c=a.j[b];if(c.Aa){if(!Rh(a,a.j,c,!0))break;b=0}}}
function Xc(a,b,c,d,e){var f=!1;if(!a.ra++)for(var g=1;!f&&g<d.length;g++){var h=d[g];if(!e||h.Aa)for(var k=lh(h),l=0;l<c;l++)if(b+l==k){var p;f=!0;h.Aa&&(Rh(a,d,h,!0),e=!0);if(p=h.rd){f=!1;for(var u=0;u<p.length;u++)if(!Uh(a,p[u],!0)){if(p[u].indexOf("if")){f=!0;break}for(var y=u+1;y<p.length&&p[y].indexOf("else");y++)u++;if(y==p.length){f=!0;break}}a.w.flags.ia||(f=!0)}if(f){e||Sh(a,d,g,"hit");break}}}a.ra--;return f}
function Vh(a,b,c,d){for(var e=gh(b.K),f=a.Ea(b,1),g=a.ma[f],h="",k=(a.style!=Wh?Xh:Yh)[g[0]],l=g.length-1,p=Zh,u,y=1;y<=l;y++){var q="";u=g[y];if(void 0!==u&&!(u&Q&&a.style==fh)){var w=u&$h;if(w){var z=u&ai;z?p=z:u|=p;u&bi||(u|=1==y?ci:di);if(w&R)a:{q=a;w=u;z=b;switch(w&ai){case ei:z=r(q.Ea(z,1),2);break;case fi:z=r(q.Ea(z,1)<<24>>24,4);break;case gi:z=r(q.Db(z,2),4);break;default:q="imm("+t(w)+")";break a}q.style==Wh&&w&hi?z="["+z+"]":w&ii||(z=(q.style==fh?"$":"0x")+z);q=z}else w&ii?(q=(u&ji)>>
8,w=th[q],a.style==Wh&&u&hi&&(q==Ch&&(w="HL"),w="["+w+"]"),q=w):w&ki&&(q=(f>>3&7).toString());if(!q||!q.length){h="INVALID";break}0<h.length&&(h+=",");h+=q||"???"}}}f="";g=rh(e)+" ";if(-1!==e.K&&-1!==b.K){do if(f+=r(a.Ea(e,1),2),null==e.K)break;while(e.K!=b.K)}g+=Ga(f,10);g+=u&li?"*":" ";g+=Ga(k,7);h&&(g+=" "+h);c&&(g=Ga(g,40)+";"+c,g=a.w.flags.Ua?g+("cycles="+rd(a.w).toString()+" cs="+r(a.w.ua)):g+(null!=d?"="+d.toString():""));return g}
function mi(a,b){switch(b){case "IF":a=a.w.M&512;break;case "SF":a=Vd(a.w);break;case "ZF":a=Ud(a.w);break;case "AF":a=Td(a.w);break;case "PF":a=Sd(a.w);break;case "CF":a=Qd(a.w);break;default:a=0}return b.charAt(0)+(a?"1":"0")+" "}function ni(a,b){return th[b]+"="+uh(a,b)+" "}function oi(a){return ni(a,vh)+ni(a,Dh)+ni(a,Eh)+ni(a,Fh)+ni(a,Gh)+mi(a,"IF")+mi(a,"SF")+mi(a,"ZF")+mi(a,"AF")+mi(a,"PF")+mi(a,"CF")}m.zc=function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0};
function pi(a,b,c){var d=[],e=lh(b)>>>0;for(b=0;b<a.C.length;b++){var f=a.C[b],g=f.K>>>0,h=f.Pd;if(e>=g&&e<g+h){e=Pa(f.xc,[e-g],a.zc);0<=e?qi(a,b,e,d):c&&(e=~e,qi(a,b,e-1,d),qi(a,b,e,d));break}}return d}function qi(a,b,c,d){var e={},f=a.C[b].xc,g=0,h=null;0<=c&&c<f.length&&(g=f[c][0],h=f[c][1]);h&&(e=a.C[b].pa[h],h="."==h.charAt(0)?null:e.l||h);d.push(h);d.push(g);d.push(e.a);d.push(e.c)}
function ri(a,b){if("?"==b)a.i("frequency commands:"),a.i("\tclear\tclear all frequency counts");else{var c=0;if(a.D)if("clear"==b){for(b=0;b<a.D.length;b++)a.D[b]=[b,0];a.i("frequency data cleared");c++}else if(void 0!==b)a.i("unknown frequency command: "+b),c++;else{var d=a.D.slice();d.sort(function(h,k){return k[1]-h[1]});var e=a.style!=Wh?Xh:Yh;for(b=0;b<d.length;b++){var f=d[b][0],g=d[b][1];g&&(a.i((e[a.ma[f][0]]+"  ").substr(0,5)+" ("+za(f)+"): "+g+" times"),c++)}}c||a.i("no frequency data available")}}
function si(a,b){var c=b.match(/^\s*([A-Z_]?[A-Z0-9_]*)\s*(=?)\s*(.*)$/i);if(c){if(!c[1])return dh(a)||a.i("no variables"),!0;if(!c[2])return dh(a,c[1]);if(!c[3])return delete a.A[c[1]],!0;b=ah(a,c[3]);return void 0!==b?(a.A[c[1]]={value:b,oe:void 0},!0):!1}a.i("invalid assignment:"+b);return!1}
function ti(a,b,c){var d=null;if(b=mh(a,b,!0)){var e=pi(a,b,!0);if(e.length){var f;if(e[0]){var g="";(f=b.K-e[1])&&(g=" + "+t(f));f=e[0]+" ("+r(e[1],4)+")"+g;c&&a.i(f);d=f}4<e.length&&e[4]&&(g="",(f=e[5]-b.K)&&(g=" - "+t(f)),f=e[4]+" ("+r(e[5],4)+")"+g,c&&a.i(f),d||(d=f))}else c&&a.i("no symbols")}return d}
function ui(a,b){switch(b[1]){case "8080":a.style=fh;break;case "8086":a.style=Wh;break;case "cs":var c;void 0!==b[3]&&(c=+b[3]);switch(b[2]){case "int":a.w.la=c;break;case "start":a.w.wa=c;break;case "stop":a.w.qa=c;break;default:a.i("unknown cs option");return}void 0!==c&&cd(a.w);a.i("checksums "+(a.w.flags.Ua?"enabled":"disabled"));return;case "sp":void 0!==b[2]&&(td(a.w,+b[2])||a.i("warning: using 1x multiplier, previous target not reached"));a.i("target speed: "+(a.w.Y.toFixed(2)+"Mhz (")+a.w.S+
"x)");return;case "?":a.i("debugger options:");a.i("\tX80\t\tselect 8080-style mnemonics");a.i("\t8086\t\tselect 8086-style mnemonics");a.i("\tcs int #\tset checksum cycle interval to #");a.i("\tcs start #\tset checksum cycle start count to #");a.i("\tcs stop #\tset checksum cycle stop count to #");a.i("\tsp #\t\tset speed multiplier to #");break;default:if(b[1]){a.i("unknown option: "+b[1]);return}}a.i(a.style+"-style mnemonics enabled")}
function Oh(a,b){var c;if(b&&"?"==b[1])a.i("register commands:"),a.i("\tr\tdump registers"),a.i("\trx [#]\tset flag or register x to [#]");else{var d=a.w;null==c&&(c=!0);if(null!=b&&1<b.length){var e=b[1],f=e.indexOf("=");if(0<f)b=e.substr(f+1),e=e.substr(0,f);else if(2<b.length)b=b[2];else{a.i("missing value for "+b[1]);return}f=ah(a,b);if(void 0===f)return;switch(e.toUpperCase()){case "A":d.g=f&255;break;case "B":d.u=f&255;break;case "BC":d.u=f>>8&255;case "C":d.A=f&255;break;case "D":d.B=f&255;
break;case "DE":d.B=f>>8&255;case "E":d.C=f&255;break;case "H":d.D=f&255;break;case "HL":d.D=f>>8&255;case "L":d.F=f&255;break;case "SP":d.L=f&65535;break;case "PC":C(d,f);a.L=gh(d.j);break;case "PS":Hd(d,f);break;case "PSW":Hd(d,f&255|d.M&-256);d.g=f>>8;break;case "CF":d.G=f?d.G|256:d.G&255;break;case "PF":f?Sd(d)||(d.I^=1):Sd(d)&&(d.I^=1);break;case "AF":d.N=f?~d.I&16|d.N&-17:d.I&16|d.N&-17;break;case "ZF":d.G=f?d.G&-256:d.G|255;break;case "SF":f?Vd(d)||(d.I^=192):Vd(d)&&(d.I^=192);break;case "IF":d.M=
f?d.M|512:d.M&-513;break;default:a.i("unknown register: "+e);return}pd(d);a.i("updated registers:")}a.i(oi(a));c&&(a.L=gh(d.j),Ph(a,rh(a.L)))}}function vi(a,b){b=Na(b);var c=b.match(/^(['"])(.*?)\1$/);c?a.i(Kh(a,c[2])):ah(a,b,!1)}function wi(a,b,c){var d="t"!=b;c=ug(a,c,void 0,!0)||1;var e=1==c?0:1;"tc"==b&&(e=c,c=1);ib(c,function(){return Tb(a,!0)&&nh(a,e,d,!1)},function(){pd(a.w);Tb(a,!1)})}
function Ph(a,b,c,d){if(b=mh(a,b,!0)){void 0===d&&(d=1);var e=256;if(void 0!==c){d=mh(a,c,!0);if(!d||d.K<b.K)return;e=d.K-b.K;if(256<e){a.i("range too large");return}d=-1}c=0;for(var f;0<e&&d--;){f=Sb(a,!1)||a.R?a.F:null;var g=null!=f?"cycles":null,h=pi(a,b),k=b.K;if(h[0]&&d&&(!c&&d||0>h[0].indexOf("+"))){var l=h[0]+":";h[2]&&(l+=" "+h[2]);a.i(l)}h[3]&&(g=h[3],f=null);f=Vh(a,b,g,f);a.i(f);a.L=b;e-=b.K-k;c++}}}
m.yb=function(a,b,c){if(b)if(a){0>this.b&&this.g.length&&(this.b=0);if(0>this.b||a!=this.g[this.b])this.g.splice(0,0,a),this.b=0;this.b--}else this.N?a="end":a=this.g[this.b+1];b=[];if(a){a=a.toLowerCase().replace(/""/g,"'");var d=0,e=null;c=c||";";for(var f=0;f<=a.length;f++){var g=a.charAt(f);if('"'==g||"'"==g)e?g==e&&(e=null):e=g;else if(g==c&&!e||!g)b.push(Na(a.substring(d,f))),d=f+1}}return b};
function Uh(a,b,c){var d=!0;try{b.length&&"end"!=b?c||a.i(">> "+b):(a.N&&(a.i("ended assemble at "+rh(a.T)),a.L=a.T,a.N=!1),b="");var e=b.charAt(0);if('"'==e||"'"==e)return!0;a.X=null;if(Qb(a)&&0<b.length){a.N&&(b="a "+rh(a.T)+" "+b);var f=b.replace(/ +/g," ").split(" ");if(f&&f.length)for(var g=f[0],h=g.charAt(0),k=1;k<g.length;k++){var l=g.charAt(k);if("?"==h||"r"==h||"a">l||"z"<l){f[0]=g.substr(k);f.unshift(g.substr(0,k));break}}switch(f[0].charAt(0)){case "a":var p=mh(a,f[1],!0);if(p)if(a.T=p,
void 0===f[2])a.i("begin assemble at "+rh(p)),a.N=!0,pd(a.w);else{a.i("not supported yet");var u=[];if(u.length){for(var y=0;y<u.length;y++)a.Wb(p,u[y],1);a.i(Vh(a,a.T))}}break;case "b":a:{var q=f[0],w=f[1],z=b;if("?"==w)a.i("breakpoint commands:"),a.i("\tbi [p]\ttoggle break on input port [p]"),a.i("\tbo [p]\ttoggle break on output port [p]"),a.i("\tbp [a]\tset exec breakpoint at addr [a]"),a.i("\tbr [a]\tset read breakpoint at addr [a]"),a.i("\tbw [a]\tset write breakpoint at addr [a]"),a.i("\tbc [a]\tclear breakpoint at addr [a]"),
a.i("\tbl\tlist all breakpoints"),a.i("\tbn [n]\tbreak after [n] instruction(s)");else{var D=q.charAt(1);if("l"==D){var G=Th(a,a.j);G+=Th(a,a.M);(G+=Th(a,a.B))||a.i("no breakpoints")}else if("n"==D)a.W=ug(a,w),a.i("break after "+a.W+" instruction(s)");else if(void 0===w)a.i("missing breakpoint address");else{var F=gh();if("*"!=w&&(F=mh(a,w,!0),!F))break a;w=t(F.K);"c"==D?null==F.K?(hh(a),a.i("all breakpoints cleared")):Rh(a,a.j,F)||Rh(a,a.M,F)||Rh(a,a.B,F)||a.i("breakpoint missing: "+rh(F)):"i"==
D?a.i("breakpoint "+(Ac(a.H,F.K)?"enabled":"cleared")+": port "+w+" (input)"):"o"==D?a.i("breakpoint "+(Ec(a.H,F.K)?"enabled":"cleared")+": port "+w+" (output)"):null!=F.K&&(qh(a,F,z),"p"==D?a.Ma(a.j,F):"r"==D?a.Ma(a.M,F):"w"==D?a.Ma(a.B,F):a.i("unknown breakpoint command: "+D))}}}break;case "c":var ca=a.P;ca.B&&(ca.B.value="");break;case "d":a:{var la,ma=f[0],ta=f[1],ya=f[2],Yi=f[3];if("?"==ta){var Wb="";for(la in ac)a.ja[la]&&(Wb&&(Wb+=","),Wb+=la);Wb+=",state,symbols";a.i("dump memory commands:");
a.i("\tdb [a] [#]    dump # bytes at address a");a.i("\tdw [a] [#]    dump # words at address a");a.i("\tdd [a] [#]    dump # dwords at address a");a.i("\tdh [#] [#]    dump # instructions from history");Wb.length&&a.i("dump extension commands:\n\t"+Wb)}else if("state"==ta){var me=xi(a.P,!0);if("console"==ya)console.log(me);else{var yg=a.P;yg.B&&(yg.B.value="");me&&a.i(me)}}else if("symbols"==ta)for(var ne=0;ne<a.C.length;ne++){var oe=a.C[ne],Xb;for(Xb in oe.pa)if("."!=Xb.charAt(0)){var zg=oe.pa[Xb].o;
if(void 0!==zg){var Ag=oe.pa[Xb].l;Ag&&(Xb=Ag);a.i(r(zg,4)+" "+Xb)}}}else{if("d"==ma){for(la in ac)if(f[1]==la){var Bg=a.ja[la];Bg?(f.shift(),f.shift(),Bg(f)):a.i("no dump registered for "+ta);break a}ta||(ma=a.Ba||"db")}else a.Ba=ma;if("dh"==ma){var Cg=ta,Dg=ya,Eg="",Fg=0,Qa=a.U,db=a.G;if(db.length){var Ea=+Cg||a.ua,qc=+Dg||10;isNaN(Ea)?Ea=qc:Eg="more ";Ea>db.length&&(a.i("note: only "+db.length+" available"),Ea=db.length);Qa-=Ea;0>Qa&&(null==db[db.length-1].K?(Ea=Qa+Ea,Qa=0):Qa+=db.length);var pe=
[];"call"==Dg&&(qc=1E5,pe=["CALL"]);void 0!==Cg&&a.i(Ea+" instructions earlier:");for(var qe="";0<qc&&Qa!=a.U;){var Gg=db[Qa++];if(null==Gg.K)break;var rc=gh(Gg.K),Zi=Ea--,Hg=Vh(a,rc,"history",Zi);if(!pe.length||0<=Hg.indexOf(pe[0]))qe+=Hg+"\n";rc.Hb&&(Qa+=rc.Hb,qc-=rc.Hb,Ea-=rc.Hb);Qa>=db.length&&(Qa=0);a.ua=Ea;Fg++;qc--}qe&&a.i(qe)}Fg||(a.i("no "+Eg+"history available"),a.ua=void 0)}else{var dd=mh(a,ta);if(dd){var ed=0;ya&&("l"==ya.charAt(0)&&(ya=ya.substr(1)||Yi),ed=ug(a,ya)>>>0,65536<ed&&(ed=
65536));for(var sc="",fd="dd"==ma?4:"dw"==ma?2:1,gd=fd*ed||128,$i=gd+15>>4||1;$i--&&0<gd;){var re=0,se=0,tc,te="",Ig="";ta=rh(dd);for(tc=16;0<tc&&0<gd;tc--){var hd=a.Ea(dd,1);re|=hd<<(se++<<3);se==fd&&(te+=r(re,2*fd),te+=1==fd?9==tc?"-":" ":"  ",re=se=0);Ig+=32<=hd&&127>hd?String.fromCharCode(hd):".";gd--}sc&&(sc+="\n");sc+=ta+"  "+te+(0==tc?" "+Ig:"")}sc&&a.i(sc);a.qa=dd}}}}break;case "e":if("else"==f[0])break;var id=1,Jg=255,Kg=a.Ea,Lg=a.Wb;"ew"==f[0]&&(id=2,Jg=65535,Kg=a.Db,Lg=a.Pc);var Mg=id<<
1,Ng=f[1];if(null==Ng)a.i("edit memory commands:"),a.i("\teb [a] [...]  edit bytes at address a"),a.i("\tew [a] [...]  edit words at address a");else{var jd=mh(a,Ng);if(jd)for(var kd=2;kd<f.length;kd++){var uc=ah(a,f[kd]);if(void 0===uc){a.i("unrecognized value: "+f[kd]);break}uc&~Jg&&a.i("warning: "+r(uc)+" exceeds "+id+"-byte value");var aj=Kg.call(a,jd);a.i("changing "+rh(jd)+" from "+r(aj,Mg,!0)+" to "+r(uc,Mg,!0));Lg.call(a,jd,uc,id)}}break;case "f":ri(a,f[1]);break;case "g":a:{var Og=f[1],bj=
b;if(void 0!==Og){var ue=mh(a,Og,!0);if(!ue)break a;qh(a,ue,bj);a.Ma(a.j,ue,!0)}Mh(a,!0)||c||a.i("cpu busy or unavailable, run command ignored")}break;case "h":a:{if(a.flags.ia){var Pg="halting";Yc(a)}else{if(Sb(a,!0))break a;Pg="already halted"}c||a.i(Pg)}break;case "i":if("if"==f[0]){var vc=b.substr(2);vc=Na(vc);if(ah(a,vc)){c||a.i("true: "+vc);var Qg=!0}else c||a.i("false: "+vc),Qg=!1;Qg||(d=!1);break}if("int"==f[0]){var cj=f[1];if(a.w.M&512){var ve=ah(a,cj);if(null==ve)var we=!1;else a.i("requesting interrupt level "+
ve),he(a.w,ve),we=!0}else a.i("interrupts disabled (use rif=1 to enable)"),we=!1;we||(d=!1);break}var xe=f[1];if(xe&&"?"!=xe){var ye=ug(a,xe);if(void 0!==ye){var dj=Cc(a.H,ye);a.i(t(ye)+": "+za(dj))}}else a.i("input commands:"),a.i("\ti [p]\tread port [p]"),a.i("warning: port accesses can affect hardware state");break;case "k":var ej=f[0];if("?"==f[1])a.i("stack trace commands:"),a.i("\tk\tshow frame addresses"),a.i("\tks\tshow symbol information");else{var ze=0,Rg=gh(),wc=gh(a.w.L);for(a.i("stack trace for "+
rh(wc));10>ze;){for(var Cb=null,fj=256;65536>wc.K>>>0;){Rg.K=a.Db(wc,2);if(null==wc.K||!fj--)break;for(var gj=a,ld=Rg,Sg=null,xc=ld.K,Tg=xc,Ae=1;6>=Ae&&xc;Ae++){if(2<Ae){ld.K=xc;var md=Vh(gj,ld);if(0<=md.indexOf("CALL")){var Ug=md.indexOf(" ");if(xc+(md.indexOf(" ",Ug+1)-Ug-1)/2==Tg){Sg=md;break}}}xc--}ld.K=Tg;if(Cb=Sg)break}if(!Cb||null==Cb)break;var Vg=null;if("ks"==ej){var Wg=Cb.match(/[0-9A-F]+$/);Wg&&(Vg=ti(a,Wg[0]))}Cb=Ga(Cb,50)+"  ;"+(Vg||"stack="+rh(wc));a.i(Cb);ze++}ze||a.i("no return addresses found")}break;
case "l":"ln"==f[0]&&ti(a,f[1],!0);break;case "m":a:{var eb,fb=null,da=f[1];"?"==da&&(da=void 0);if(void 0!==da){var rb=0;if("all"==da)rb=-1610612993,da=null;else if("on"==da)fb=!0,da=null;else if("off"==da)fb=!1,da=null;else{"keys"==da&&(da="key");"kbd"==da&&(da="keyboard");for(eb in ac)if(da==eb){rb=ac[eb];fb=!!(a.fa&rb);break}if(!rb){a.i("unknown message category: "+da);break a}}if(rb)if("on"==f[2])a.fa|=rb,fb=!0;else if("off"==f[2]&&(a.fa&=~rb,fb=!1,1073741824==rb)){for(var Be=0;Be<a.Y.length;Be++)a.i(a.Y[Be]);
a.Y=[]}}var hj=0,yc="";for(eb in ac)if(!da||da==eb){var ij=!!(a.fa&ac[eb]);if(null===fb||fb==ij)yc&&(yc+=","),++hj%10||(yc+="\n\t"),"key"==eb&&(eb="keys"),yc+=eb}void 0===da&&a.i("message commands:\n\tm [category] [on|off]\tturn categories on/off");a.i((null!==fb?fb?"messages on:  ":"messages off: ":"message categories:\n\t")+(yc||"none"));ih(a)}break;case "o":var Ce=f[1],jj=f[2];if(Ce&&"?"!=Ce){var De=ug(a,Ce,"port #"),Ee=ug(a,jj);void 0!==De&&void 0!==Ee&&(Gc(a.H,De,Ee),a.i(t(De)+": "+za(Ee)))}else a.i("output commands:"),
a.i("\to [p] [b]\twrite byte [b] to port [p]"),a.i("warning: port accesses can affect hardware state");break;case "p":if("print"==f[0]){vi(a,b.substr(5));break}var Xg="pr"==f[0]?1:0,kj=1+Xg;if(a.R)a.i("step in progress");else{var Fe=gh(a.w.j);switch(a.Ea(Fe)){case 205:a.R=kj,oh(Fe,3)}a.R?(a.Ma(a.j,Fe,!0),Mh(a)||(a.P&&a.P.Wa(),a.R=0)):wi(a,Xg?"tr":"t")}break;case "r":if("reset"==b){a.P&&a.P.reset();break}Oh(a,f);break;case "s":ui(a,f);break;case "t":wi(a,f[0],f[1]);break;case "u":Ph(a,f[1],f[2],8);
break;case "v":if("var"==f[0]){si(a,b.substr(3))||(d=!1);break}a.i("PCx80 version 2.00 ("+a.w.ub+",RELEASE"+(Zb?",TYPEDARRAYS":",LONGARRAYS")+")");a.i(Wa());break;case "?":if(f[1]){vi(a,b.substr(1));break}var Ge="commands:",He;for(He in yi)Ge+="\n"+Ga(He,9)+yi[He];ie(a)||(Ge+="\nnote: frequency/history disabled if no exec breakpoints");a.i(Ge);break;default:a.i("unknown command: "+b),d=!1}}}catch(Zg){a.i("debugger error: "+(Zg.stack||Zg.message)),d=!1}return d}
function od(a,b,c){b=a.yb(b,c);for(var d in b)if(!Uh(a,b[+d]))return!1;return!0}
var yi={"?":"help/print","a [#]":"assemble","b [#]":"breakpoint",c:"clear output","d [#]":"dump memory","e [#]":"edit memory",f:"frequencies","g [#]":"go [to #]",h:"halt","i [#]":"input port #","if":"eval expression","int [#]":"request interrupt",k:"stack trace",ln:"list nearest symbol(s)",m:"messages","o [#]":"output port #",p:"step over",print:"print expression",r:"dump/set registers",reset:"reset machine",s:"set options","t [#]":"trace","u [#]":"unassemble",v:"print version","var":"assign variable"},
fh=8080,Wh=8086,Xh="NONE ACI ADC ADD ADI ANA ANI CALL CC CM CNC CNZ CP CPE CPO CZ CMA CMC CMP CPI DAA DAD DCR DCX DI EI HLT IN INR INX JMP JC JM JNC JNZ JP JPE JPO JZ LDA LDAX LHLD LXI MOV MVI NOP ORA ORI OUT PCHL POP PUSH RAL RAR RET RC RM RNC RNZ RP RPE RPO RZ RLC RRC RST SBB SBI SHLD SPHL STA STAX STC SUB SUI XCHG XRA XRI XTHL".split(" "),Yh="NONE ADC ADC ADD ADD AND AND CALL CALLC CALLS CALLNC CALLNZ CALLNS CALLP CALLNP CALLZ NOT CMC CMP CMP DAA ADD DEC DEC CLI STI HLT IN INC INC JMP JC JS JNC JNZ JNS JP JNP JZ MOV MOV MOV MOV MOV MOV NOP OR OR OUT JMP POP PUSH RCL RCR RET RETC RETS RETNC RETNZ RETNS RETP RETNP RETZ ROL ROR RST SBB SBB MOV MOV MOV MOV STC SUB SUB XCHG XOR XOR XCHG".split(" "),
wh=0,xh=1,yh=2,zh=3,Ah=4,Bh=5,Ch=6,vh=7,Dh=8,Eh=9,Fh=10,Gh=11,Hh=12,Ih=13,Jh=14,th="B C D E H L M A BC DE HL SP PC PS PSW".split(" "),ai=15,$h=240,ji=3840,bi=61440,Zh=0,ei=1,fi=2,gi=3,ii=16,R=32,hi=64,ki=128,S=vh<<8|ii|ei,T=wh<<8|ii|ei,U=xh<<8|ii|ei,V=yh<<8|ii|ei,W=zh<<8|ii|ei,X=Ah<<8|ii|ei,Y=Bh<<8|ii|ei,Z=Ch<<8|ii|ei|hi,zi=Dh<<8|ii|gi,Ai=Eh<<8|ii|gi,Bi=Fh<<8|ii|gi,Ci=Gh<<8|ii|gi,Di=Jh<<8|ii|gi,di=4096,ci=8192,Q=16384,li=32768,kh=[[45],[42,zi,R],[71,zi|hi,S|Q],[29,zi],[28,T],[22,T],[44,T,R],[63],
[45,li],[21,Bi|Q,zi],[40,S|Q,zi|hi],[23,zi],[28,U],[22,U],[44,U,R],[64],[45,li],[42,Ai,R],[71,Ai|hi,S|Q],[29,Ai],[28,V],[22,V],[44,V,R],[52],[45,li],[21,Bi|Q,Ai],[40,S|Q,Ai|hi],[23,Ai],[28,W],[22,W],[44,W,R],[53],[45,li],[42,Bi,R],[68,51|hi,Bi|Q],[29,Bi],[28,X],[22,X],[44,X,R],[20],[45,li],[21,Bi|Q,Bi],[41,Bi|Q,51|hi],[23,Bi],[28,Y],[22,Y],[44,Y,R],[16,S|Q],[45,li],[42,Ci,R],[70,51|hi,S|Q],[29,Ci],[28,Z],[22,Z],[44,Z,R],[72],[45,li],[21,Bi|Q,Ci],[39,S|Q,51|hi],[23,Ci],[28,S],[22,S],[44,S,R],[17],
[43,T,T],[43,T,U],[43,T,V],[43,T,W],[43,T,X],[43,T,Y],[43,T,Z],[43,T,S],[43,U,T],[43,U,U],[43,U,V],[43,U,W],[43,U,X],[43,U,Y],[43,U,Z],[43,U,S],[43,V,T],[43,V,U],[43,V,V],[43,V,W],[43,V,X],[43,V,Y],[43,V,Z],[43,V,S],[43,W,T],[43,W,U],[43,W,V],[43,W,W],[43,W,X],[43,W,Y],[43,W,Z],[43,W,S],[43,X,T],[43,X,U],[43,X,V],[43,X,W],[43,X,X],[43,X,Y],[43,X,Z],[43,X,S],[43,Y,T],[43,Y,U],[43,Y,V],[43,Y,W],[43,Y,X],[43,Y,Y],[43,Y,Z],[43,Y,S],[43,Z,T],[43,Z,U],[43,Z,V],[43,Z,W],[43,Z,X],[43,Z,Y],[26],[43,Z,S],[43,
S,T],[43,S,U],[43,S,V],[43,S,W],[43,S,X],[43,S,Y],[43,S,Z],[43,S,S],[3,S|Q,T],[3,S|Q,U],[3,S|Q,V],[3,S|Q,W],[3,S|Q,X],[3,S|Q,Y],[3,S|Q,Z],[3,S|Q,S],[2,S|Q,T],[2,S|Q,U],[2,S|Q,V],[2,S|Q,W],[2,S|Q,X],[2,S|Q,Y],[2,S|Q,Z],[2,S|Q,S],[73,S|Q,T],[73,S|Q,U],[73,S|Q,V],[73,S|Q,W],[73,S|Q,X],[73,S|Q,Y],[73,S|Q,Z],[73,S|Q,S],[66,S|Q,T],[66,S|Q,U],[66,S|Q,V],[66,S|Q,W],[66,S|Q,X],[66,S|Q,Y],[66,S|Q,Z],[66,S|Q,S],[5,S|Q,T],[5,S|Q,U],[5,S|Q,V],[5,S|Q,W],[5,S|Q,X],[5,S|Q,Y],[5,S|Q,Z],[5,S|Q,S],[76,S|Q,T],[76,S|
Q,U],[76,S|Q,V],[76,S|Q,W],[76,S|Q,X],[76,S|Q,Y],[76,S|Q,Z],[76,S|Q,S],[46,S|Q,T],[46,S|Q,U],[46,S|Q,V],[46,S|Q,W],[46,S|Q,X],[46,S|Q,Y],[46,S|Q,Z],[46,S|Q,S],[18,S|Q,T],[18,S|Q,U],[18,S|Q,V],[18,S|Q,W],[18,S|Q,X],[18,S|Q,Y],[18,S|Q,Z],[18,S|Q,S],[58],[50,zi],[34,51],[30,51],[11,51],[51,zi],[4,S|Q,R|ei],[65,ki],[62],[54],[38,51],[30,51|li],[15,51],[7,51],[1,S|Q,R|ei],[65,ki],[57],[50,Ai],[33,51],[48,R|ei,S|Q],[10,51],[51,Ai],[74,S|Q,R|ei],[65,ki],[55],[54,li],[31,51],[27,S|Q,R|ei],[8,51],[7,51|li],
[67,S|Q,R|ei],[65,ki],[61],[50,Bi],[37,51],[78,Ci|hi|Q,Bi|Q],[14,51],[51,Bi],[6,S|Q,R|ei],[65,ki],[60],[49,Bi],[36,51],[75,Bi|Q,Ai|Q],[13,51],[7,51|li],[77,S|Q,R|ei],[65,ki],[59],[50,Di],[35,51],[24],[12,51],[51,Di],[47,S|Q,R|ei],[65,ki],[56],[69,Ci|Q,Bi|Q],[32,51],[25],[9,51],[7,51|li],[19,S|Q,R|ei],[65,ki]],Lh=1E3;lb(function(){for(var a=Eb(document,"pcx80","debugger"),b=0;b<a.length;b++){var c=a[b],d=Fb(c);d=new eh(d);Db(d,c)}});
function Ei(a,b,c){x.call(this,"Computer",a,16384);this.flags.ha=!1;Fi(this,b);this.L=ad(this,"autoPower",a);this.j=0;this.T=a.busWidth||a.buswidth;this.b=Gi;this.G=null;this.D=this.R=!1;this.url=ad(this,"url")||"";(Math.random()+.1).toString(36);this.g=Hi(this);if(this.w=Ib("CPU",this.id)){this.J=Ib("Debugger",this.id);this.A=[];for(b=null;b=cc(this,"Video",b);)this.A.push(b);this.H=new ec({id:this.Pa+".bus",busWidth:this.T},this.w,this.J);var d=Gb(this.id);if(this.B=(this.C=Ib("Panel",this.id))&&
this.C.O.print)for(b=0;b<d.length;b++){var e=d[b];e.Z=this.C.Z;e.print=this.C.print;e.i=this.C.i}this.i("PCx80 v2.00\nCopyright \u00a9 2012-2021 Jeff Parsons <Jeff@pcjs.org>\nLicense: MIT <https://www.pcjs.org/LICENSE.txt>");for(b=0;b<d.length;b++)e=d[b],e.Da&&e.Da(this,this.H,this.w,this.J);b=null;e=ad(this,"resume",a);void 0!==e&&(1<e.length?b=this.F=e:this.b=parseInt(e,10));e=!1;d=ad(this,"state");d||(e=!0,d=a.state);d&&(b=this.M=d,e||(this.D=!0,this.b=Gi),this.b&&(this.I=new Kd(this,"2.00"),this.I.load()?
b=null:delete this.I));!b&&this.b&&(b=Ii(this))&&(this.D=!0);if(b){var f=this;Sa(b,null,!0,function(g,h,k){k?(f.F=null,f.D=!1,f.Z("Unable to load machine state from server (error "+k+(h?": "+Na(h):"")+")")):(f.G=h,f.R=!0);Rb(f)})}else Rb(this);this.O.power||(this.L=!0);!c&&this.L&&this.wait(this.jb)}else v("Unable to find CPU component")}oa(Ei,x);function Fi(a,b){if(!b){var c;if("object"==typeof resources&&(c=resources.parms))try{b=eval("("+c+")")}catch(d){v(d.message+" ("+c+")")}}a.S=b}
function ad(a,b,c){var d=b.toLowerCase();d=gb(b)||gb(d);void 0===d&&a.S&&(d=a.S[b]);void 0===d&&c&&(d=c[b]);void 0===d&&"object"==typeof resources&&resources[b]&&(d=b);return d}m=Ei.prototype;m.wait=function(a,b){for(var c=this,d=Gb(this.id),e=0;e<=d.length;e++){var f=e<d.length?d[e]:this;if(!Qb(f)){Qb(f,function(){c.wait(a,b)});return}}a.call(this,b)};
function Ji(a,b){var c=new Kd(a,"2.00",Ki);if(c.load()&&Li(c)){var d=c.get(Mi),e=b?b.get(Mi):"unknown";d!=e&&(a.Z("Machine state may be out-of-date\n("+d+" vs. "+e+")\nCheck your browser's local storage limits"),b||c.clear())}}
m.jb=function(a){void 0===a&&(a=this.b||(this.G?Ni:Gi));if(!this.j){this.j++;var b=!1,c=!1;this.N=!1;var d=this.I||new Kd(this,"2.00");if(a==Oi)b=!0;else if(a>Gi){if(d.load(this.G)){this.u=new Kd(this,"2.00",Pi);this.u.load()&&(Qi(),a=Ri,Si(this.u));this.u.set(Mi,Ia("%T",new Date));this.u.store();var e=this.b&&!this.D;if(a==Ni||Ab("Click OK to restore the previous PCx80 machine state, or CANCEL to reset the machine.")){if(c=Li(d)){var f=d.get("code"),g=d.get("data");f&&("ok"==f?d.load(g):("error"==
f&&"no machine state"!=g?(this.Z("Error: "+g),"unable to verify user"==g&&($a(Ti,""),this.g=null)):this.i(f+": "+g),Si(d),d.load()?(c=Li(d),e=!0):c=!1))}e&&Ji(this,c?d:null)}else a==Ri&&d.clear()}else Ji(this);delete this.G;delete this.I}e=Gb(this.id);for(f=0;f<e.length;f++)g=e[f],g!==this&&g!=this.w&&(c=Ui(this,g,d,b,c));b=[d,a,c];a!=Oi?this.wait(this.Bc,b):this.Bc(b)}};
function Ui(a,b,c,d,e){if(!b.flags.ha){b.flags.ha=!0;if(b.ta){var f=null;e&&((f=c.get(b.id))||(f=c.get(b.id.replace(/-[0-9]+\./i,"."))));"string"===typeof f&&(f=null);!b.ta(f,d)&&f&&(v("Unable to restore state for "+b.type),a.M&&!a.R?(c.clear(),a.b=Gi,window&&window.location.reload()):a.N=!0,b.ta(null),e=!1)}if(!d&&b.uc)for(a=b.uc.split("|"),c=0;c<a.length;c++)b.status(a[c])}return e}
m.Bc=function(a){var b=a[0],c=0>a[1];a=a[2];this.V=!0;this.flags.ha=!0;var d=this.O.power;d&&(d.textContent="Shutdown");this.w&&(Ui(this,this.w,b,c,a),this.w.gb());this.N&&(Qi(),b.clear());!c&&this.u&&(this.u.clear(),delete this.u);this.j=0};function Qi(){nb("There may be a problem with your PCx80 machine.")}
function xi(a,b,c){var d="none";if(a.j)return null;a.j--;var e=new Kd(a,"2.00"),f=new Kd(a,"2.00",Ki),g=Ia("%T",new Date);f.set(Mi,g);e.set(Mi,g);e.set(Vi,"2.00");e.set(Wi,window?window.location.href:null);e.set(Xi,Wa());if(a.w&&a.w.sa){c&&sd(a.w);var h=a.w.sa(b,c);"object"===typeof h&&e.set(a.w.id,h);c&&(a.w.flags.ha=!1,!1===h&&(d=null))}g=Gb(a.id);for(var k=0;k<g.length;k++){var l=g[k];l.flags.ha&&(l.sa&&(h=l.sa(b,c),"object"===typeof h&&e.set(l.id,h)),c&&(l.flags.ha=!1,!1===h&&(d=null)))}d&&(c?
(g=h=!1,b?(a.g&&lj(a,a.g,e.toString()),f.store()&&e.store()||(d=null,h=g=!0)):a.b&&(h=!0,g=a.b==mj),h&&e.clear(g)):d=e.toString());c&&(a.flags.ha=!1,b=a.O.power)&&(b.textContent="Power");a.j=0;return d}m.reset=function(){this.H&&this.H.reset&&(Vb(this,"Resetting "+this.H.type),this.H.reset());for(var a=Gb(this.id),b=0;b<a.length;b++){var c=a[b];c!==this&&c!==this.H&&c.reset&&(Vb(this,"Resetting "+c.type),c.reset())}};
m.start=function(a,b){for(var c=Gb(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.start&&e.start(a,b)}};m.stop=function(a,b){for(var c=Gb(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.stop&&e.stop(a,b)}};
m.ca=function(a,b,c){var d=this;switch(b){case "power":return this.O[b]=c,c.onclick=function(){d.j||(d.flags.ha?xi(d,!1,!0):d.wait(d.jb))},!0;case "reset":return this.O[b]=c,c.onclick=function(){if(d.flags.ha&&!d.j)if(d.b&&!d.F){var e=Ab("Click OK to save changes to this PCx80 machine.\n\nWARNING: If you CANCEL, all disk changes will be discarded.");xi(d,e,!0);!e&&d.M?window&&window.location.reload():d.jb(Gi)}else d.reset(),d.w&&d.w.gb()},!0;case "save":if(Ca())c.parentNode.removeChild(c);else return this.O[b]=
c,c.onclick=function(){var e=Hi(d,!0);if(e){var f=!!(d.b&&!d.F||d.M),g=xi(d,f);f?lj(d,e,g):d.Z("Resume disabled, machine state not saved")}},!0}return!1};function Hi(a,b){var c=a.g;c||((c=Za(Ti),void 0!==c)?!c&&b&&(b=null,window&&(b=window.prompt("Saving machine states on the pcjs.org server is currently unsupported.\n\nIf you're running your own server, enter your user ID below.","")),c=b)&&((c=nj(a,c))||a.Z("The user ID is invalid.")):b&&a.Z("Browser local storage is not available"));return c}
function nj(a,b){a.g=null;b=Sa(Ua()+"/api/v1/user?req=verify&user="+b);var c=b[1];if(!b[0]&&c)try{b=eval("("+c+")"),b.code&&"ok"==b.code&&($a(Ti,b.data),a.g=b.data)}catch(d){v(d.message+" ("+c+")")}return a.g}function Ii(a){var b=null;a.g&&(b=Ua()+"/api/v1/user?req=load&user="+a.g+"&state="+oj(a,"2.00"));return b}
function lj(a,b,c){if(c){var d={req:"store"};d.user=b;d.state=oj(a,"2.00");d.data=c;b=Sa(Ua()+"/api/v1/user",d);d=b[0];if(b[1]){if(d){var e=d.indexOf("\n");0<e&&(d=d.substr(0,e));d.indexOf("Error: ")||(d=d.substr(7))}d='{"code":'+b[1]+',"data":"'+d+'"}'}b=JSON.parse(d);b&&"ok"==b.code?a.Z("Machine state saved to server"):c&&(c=b&&b.data||"unable to save machine state",c="error"==b.code?"Error: "+c:"Error "+b.code+": "+c,a.Z(c),$a(Ti,""),a.g=null)}}
function cc(a,b,c){a=Gb(a.id);for(var d=0;d<a.length;d++){var e=a[d];if(c)c==e&&(c=null);else if(e.type==b)return e}return null}m.Wa=function(a){if(this.A.length){var b=0,c=0;!a&&window&&(b=window.scrollX,c=window.scrollY);var d=this.A[0];d.U&&d.U.focus();!a&&window&&window.scrollTo(b,c)}};
function Ad(a,b){a.w&&(a=a.w,a.cb&&(b||!a.flags.ia||a.flags.Ac)&&(L(a,"A",a.g),L(a,"B",a.u),L(a,"C",a.A),L(a,"BC",Ld(a),4),L(a,"D",a.B),L(a,"E",a.C),L(a,"DE",Nd(a),4),L(a,"H",a.D),L(a,"L",a.F),L(a,"HL",E(a),4),L(a,"SP",a.L,4),L(a,"PC",a.j,4),b=Jd(a),L(a,"PS",b,4),L(a,"IF",b&512?1:0,1),L(a,"SF",b&128?1:0,1),L(a,"ZF",b&64?1:0,1),L(a,"AF",b&16?1:0,1),L(a,"PF",b&4?1:0,1),L(a,"CF",b&1?1:0,1)),b=a.O.speed)&&(b.textContent=a.flags.ia&&a.X?a.X.toFixed(2)+"Mhz":"Stopped")}
var Pi="failsafe",Ki="validate",Mi="timestamp",Vi="version",Wi="url",Xi="browser",Ti="user",Oi=-1,Gi=0,Ni=1,Ri=2,mj=3;lb(function(){for(var a=Eb(document,"pcx80-machine"),b=0;b<a.length;b++){var c=a[b],d=Fb(c);c=Eb(c,"pcx80","computer");for(var e=0;e<c.length;e++){var f=c[e],g=Fb(f);g=new Ei(g,d,!0);Db(g,f);g.L&&g.wait(g.jb)}}});mb.show.push(function(){for(var a=Eb(document,"pcx80","computer"),b=0;b<a.length;b++){var c=Fb(a[b]);if(c=Ib("Computer",c.id))c.flags.Pb=!1,c.V&&!c.flags.ha&&c.jb(Oi)}});
mb.exit.push(function(){for(var a=Eb(document,"pcx80","computer"),b=0;b<a.length;b++){var c=Fb(a[b]);if(c=Ib("Computer",c.id))c.flags.Pb=!0,c.flags.ha&&xi(c,!(!c.b||c.F),!0)}});function Kd(a,b,c){this.id=a.id;this.J=a.J;this.g="";this.b={};this.w=this.H=!1;this.key=oj(a,b,c);Si(this,a.Bd)}m=Kd.prototype;m.set=function(a,b){try{this.b[a]=b}catch(c){}};m.get=function(a){return this.b[a]||null};m.data=function(){return this.b};
m.load=function(a){return a?(this.g=a,this.w=!0,this.H=!1,!0):this.w?!0:Xa()&&(a=Za(this.key))?(this.g=a,this.w=!0):!1};function Li(a){var b=!0;if(!a.H)try{a.b=JSON.parse(a.g),a.H=!0}catch(c){v(c.message||c),b=!1}return b}m.store=function(){var a=!0;if(Xa()){var b=JSON.stringify(this.b);$a(this.key,b)||(v("Unable to store "+b.length+" bytes in browser local storage"),a=!1)}return a};m.toString=function(){return this.b?JSON.stringify(this.b):this.g};
function Si(a,b){a.g="";a.b={};a.w=a.H=!1;b&&a.set("parms",b)}m.clear=function(a){Si(this);var b=[];try{for(var c=0,d=window.localStorage.length;c<d;c++)b.push(window.localStorage.key(c))}catch(e){}for(c=0;c<b.length;c++)if((d=b[c])&&(a||d.substr(0,this.key.length)==this.key)){try{window.localStorage.removeItem(d)}catch(e){}b.splice(c,1);c=0}};function oj(a,b,c){a=a.id;if(b){var d=b.indexOf(".");0<d&&(a+=".v"+b.substr(0,d))}c&&(a+="."+c);return a}var pj=0;
function qj(a,b,c,d,e,f,g){f("Loading "+a+"...");Sa(a,null,!0,function(h,k,l){l?(k||(k="unable to load "+a+" ("+l+")"),g(h,k,null)):rj(k,a,b,c,d,e,f,g)})}
function rj(a,b,c,d,e,f,g,h){function k(l,p,u){if(u)h(l,u,null);else{c&&(xb(c,b,p),(u=b)&&0>u.indexOf("/")&&"/"==window.location.pathname.slice(-1)&&(u=window.location.pathname+u),d?"}"==d.slice(-1)?(d=d.slice(0,-1),1<d.length&&(d+=",")):d='{state:"'+d+'",':d="{",d+='url:"'+u+'"}',"object"==typeof resources&&(u=null),d=d.replace(/\$/g,"$$$$").replace(/'/g,"&apos;"),e&&(l=p.match(/(<machine[^>]*\sclass=)(['"])(.*?)(\2[^>]*>)/))&&(p=p.replace(l[0],l[1]+l[2]+e+l[4]),e=""),(l=p.match(/(<machine[^>]*\sdebugger=)(['"])(available)(\2[^>]*>)/))&&
(p=p.replace(l[0],l[1]+l[2]+"optional"+l[4])),p=p.replace(/(<machine[^>]*\sid=)(['"]).*?\2/,"$1$2"+c+"$2"+(e?' class="'+e+'"':"")+(d?" parms='"+d+"'":"")+(u?' url="'+u+'"':"")));f||(p=p.replace(/(<xsl:variable name="APPNAME">).*?(<\/xsl:variable>)/,"$1PCx80$2"),p=p.replace(/(<xsl:variable name="APPCLASS">).*?(<\/xsl:variable>)/,"$1pcx80$2"),p=p.replace(/<xsl:variable name="APPVERSION"(\/>|>[^<]*<\/xsl:variable>)/,'<xsl:variable name="APPVERSION">2.00</xsl:variable>'));l=null;if("<"==p.charAt(0))try{f||
(p=p.replace(/<!DOCTYPE(.|[\r\n])*]>\s*/g,"")),window.ActiveXObject||"ActiveXObject"in window?(l=new window.ActiveXObject("Microsoft.XMLDOM"),l.async=!1,l.loadXML(p)):l=(new window.DOMParser).parseFromString(p,"text/xml")}catch(y){l=null,p=y.message}else p="unrecognized XML: "+(255<p.length?p.substr(0,255)+"...":p);h(b,p,l)}}a?f?sj(b,a,g,k):k(b,a,""):h(b,"no data",null)}
function sj(a,b,c,d){var e;if(e=/<([a-z]+)\s+ref="(.*?)"(.*?)\/>/g.exec(b)){var f=e[2];c("Loading "+f+"...");Sa(f,null,!0,function(g,h,k){if(k||!h)d(g,b,"unable to resolve XML reference: "+e[0]+" ("+k+")");else{if(k=e[3]){var l=h.match(new RegExp("<"+e[1]+"[^>]*>"));if(l){for(var p=l[0],u,y=/( [a-z]+=)(['"])(.*?)\2/gi;u=y.exec(k);)p=0>p.toLowerCase().indexOf(u[1].toLowerCase())?p.replace(">",u[0]+">"):p.replace(new RegExp(u[1]+"(['\"])(.*?)\\1"),u[0]);l[0]!=p&&(h=h.replace(l[0],p))}else{d(g,b,"missing <"+
e[1]+"> in "+f);return}}h=h.replace(/<\?xml[^>]*>[\r\n]*/,"");b=b.replace(e[0],h);sj(g,b,c,d)}})}else d(a,b,"")}
function tj(a,b,c,d,e){function f(w){if(void 0===l){var z=k&&Eb(k,"machine-warning");l=z&&z[0]||k}l&&(l.innerHTML=Da(w))}function g(w,z){if("string"==typeof z&&0<=z.indexOf("<!DOCTYPE html>")){var D=z.match(/<title>(?:PCjs: |)(.*?)<\/title>/);D&&(z=D[1])}f("Error: "+z+(w?" ("+w+")":""));p&&h();p=!1}function h(){--pj||sb(!0)}var k,l,p=!0;pj++;yb[a]={};if(!b)return d&&xb(a,"parms",d),h(),p;"true"==gb("debugger")&&0>b.indexOf("/debugger")&&(b=b.replace("/machine.xml","/debugger/machine.xml"));try{if(k=
document.getElementById(a)){var u;if("object"==typeof resources&&(u=resources.css)){var y=document.head||document.getElementsByTagName("head")[0],q=document.createElement("style");q.type="text/css";q.styleSheet?q.styleSheet.cssText=u:q.appendChild(document.createTextNode(u));y.appendChild(q)}c||(c="/configs/pcx80/xsl/components.xsl");u=function(w,z,D){D?qj(c||"","","","",!1,f,function(G,F,ca){if(ca)if(xb(a,c||"",F),f("Processing "+b+"..."),window.ActiveXObject||"ActiveXObject"in window)(ca=D.transformNode(ca))?
(k.outerHTML=ca,h()):g(G,"transformNodeToObject failed");else if(document.implementation&&document.implementation.createDocument)if(F=new XSLTProcessor,F.importStylesheet(ca),ca=F.transformToFragment(D,document))if(F=k.parentNode){var la=G=0,ma=k.getBoundingClientRect();0>ma.bottom&&(G=window.scrollX,la=window.scrollY);F.replaceChild(ca,k);(k=document.getElementById(a))&&0>ma.bottom&&(ca=k.getBoundingClientRect(),la=window.performance&&window.performance.navigation.type==window.performance.navigation.TYPE_RELOAD?
0:la+Math.ceil(ca.height-ma.height),window.scrollTo(G,la));h()}else g(G,"invalid machine element: "+a);else g(G,"transformToFragment failed");else g(G,"unable to transform XML: unsupported browser");else g(G,F)}):g(w,z)};"<"!=b.charAt(0)?qj(b,a,d||"",e||"",!0,f,u):rj(b,"",a,d||"",e||"",!1,f,u)}else g(b,"missing machine element: "+a)}catch(w){g(b,w.message)}return p}window.embedPCx80=function(a,b,c,d,e){sb(!1);return tj(a,b,c,d,e)};
window.commandMachine=function(a,b,c,d,e,f){if("script"==e){d=!1;c+=".machine";if(!f)delete Kb[c],d=!0;else if("string"==typeof f&&!Kb[c]){d=!0;e=Kb;for(var g=c,h=f.length,k=[],l=[],p="",u=null,y=0;y<h;y++){var q=f[y];if('"'==q||"'"==q)u&&q!=u?p+=q:(u?u=null:u=q,p&&(l.push(p),p=""));else{if(!u){if("\r"==q||"\n"==q)q=";";if(" "==q||"\t"==q||";"==q){p&&(l.push(p),p="");";"==q&&l.length&&(k.push(l),l=[]);continue}}p+=q}}p&&l.push(p);l.length&&k.push(l);e[g]=k;Jb(c)||(d=!1)}return d?(b&&(a.disabled=!0),
!0):!1}if(d&&(g=Ib(d,c+".machine"))&&(h=g.exports)&&(h=h[e]))return h.call(g,f)?(b&&(a.disabled=!0),!0):!1;console.log("unimplemented: commandMachine('"+c+"','"+d+"','"+e+"','"+f+"')");return!1};window.enableEvents=sb;window.sendEvent=ub;})()

//# sourceMappingURL=pcx80.js.map
